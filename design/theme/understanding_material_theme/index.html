
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://docs.compose.net.cn/design/theme/understanding_material_theme/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>深入理解 MaterialTheme 与 CompositionLocal - Jetpack Compose</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7CJetbrains+Mono&display=fallback">
        <style>:root{--md-text-font-family:"";--md-code-font-family:"Jetbrains Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-materialtheme" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Jetpack Compose" class="md-header__button md-logo" aria-label="Jetpack Compose" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jetpack Compose
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              深入理解 MaterialTheme 与 CompositionLocal
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/Compose-Museum/Compose-Tutorial/" title="前往 GitHub 仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Jetpack Compose 博物馆
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link md-tabs__link--active">
        Jetpack Compose
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../third-party-component/accompanist/overview/" class="md-tabs__link">
        第三方组件
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../api/elements/text/" class="md-tabs__link">
        API 文档
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Jetpack Compose" class="md-nav__button md-logo" aria-label="Jetpack Compose" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Jetpack Compose
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Compose-Museum/Compose-Tutorial/" title="前往 GitHub 仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Jetpack Compose 博物馆
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      <label class="md-nav__link" for="__nav_1">
        Jetpack Compose
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Jetpack Compose" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Jetpack Compose
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../start/" class="md-nav__link">
        在开始之前
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorial/" class="md-nav__link">
        快速入门
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      <label class="md-nav__link" for="__nav_1_4">
        基本组件
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="基本组件" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          基本组件
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/alertdialog/" class="md-nav__link">
        AlertDialog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/button/" class="md-nav__link">
        Button
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/card/" class="md-nav__link">
        Card
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/floatingactionbutton/" class="md-nav__link">
        FloatingActionButton
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/icon/" class="md-nav__link">
        Icon
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/image/" class="md-nav__link">
        Image
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/iconbutton/" class="md-nav__link">
        IconButton
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/surface/" class="md-nav__link">
        Surface
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/slider/" class="md-nav__link">
        Slider
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/text/" class="md-nav__link">
        Text
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../elements/textfield/" class="md-nav__link">
        TextField
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      <label class="md-nav__link" for="__nav_1_5">
        布局
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="布局" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          布局
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/bottomnavigation/" class="md-nav__link">
        BottomNavigation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/column/" class="md-nav__link">
        Column
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/modalbottomsheetlayout/" class="md-nav__link">
        ModalBottomSheetLayout
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/row/" class="md-nav__link">
        Row
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/spacer/" class="md-nav__link">
        Spacer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/scaffold/" class="md-nav__link">
        Scaffold
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/topappbar/" class="md-nav__link">
        TopAppBar
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/custom_layout/" class="md-nav__link">
        自定义Layout
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../layout/intrinsic/" class="md-nav__link">
        固有特性测量
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" checked>
      
      <label class="md-nav__link" for="__nav_1_6">
        设计
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="设计" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          设计
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_1" type="checkbox" id="__nav_1_6_1" >
      
      <label class="md-nav__link" for="__nav_1_6_1">
        动画
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="动画" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_1">
          <span class="md-nav__icon md-icon"></span>
          动画
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../animation/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../animation/animationvisibility/" class="md-nav__link">
        AnimationVisibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../animation/animatestate/" class="md-nav__link">
        Animate*State
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../animation/animatable/" class="md-nav__link">
        Animatable
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_2" type="checkbox" id="__nav_1_6_2" checked>
      
      <label class="md-nav__link" for="__nav_1_6_2">
        主题
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="主题" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_2">
          <span class="md-nav__icon md-icon"></span>
          主题
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../meet_material_theme/" class="md-nav__link">
        初识 MaterialTheme
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          深入理解 MaterialTheme 与 CompositionLocal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        深入理解 MaterialTheme 与 CompositionLocal
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-materialtheme" class="md-nav__link">
    1. MaterialTheme 是怎么做到的
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-compositionlocal" class="md-nav__link">
    2. CompositionLocal介绍
  </a>
  
    <nav class="md-nav" aria-label="2. CompositionLocal介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compositionlocalof-staticcompositionlocalof" class="md-nav__link">
    compositionLocalOf 与 staticCompositionLocalOf 区别
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../custom_your_theme/" class="md-nav__link">
        自定义你的主题方案
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_3" type="checkbox" id="__nav_1_6_3" >
      
      <label class="md-nav__link" for="__nav_1_6_3">
        手势
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="手势" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_3">
          <span class="md-nav__icon md-icon"></span>
          手势
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gesture/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gesture/draggable/" class="md-nav__link">
        Draggable拖动
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gesture/swipeable/" class="md-nav__link">
        Swipeable滑动
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gesture/transformer/" class="md-nav__link">
        Transformer双指拖动、缩放与旋转
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gesture/custom_gesture/" class="md-nav__link">
        自定义触摸反馈
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_4" type="checkbox" id="__nav_1_6_4" >
      
      <label class="md-nav__link" for="__nav_1_6_4">
        列表
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="列表" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_4">
          <span class="md-nav__icon md-icon"></span>
          列表
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../lists/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../draw/custom_draw/" class="md-nav__link">
        绘制
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" type="checkbox" id="__nav_1_7" >
      
      <label class="md-nav__link" for="__nav_1_7">
        关于 Modifier
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="关于 Modifier" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          关于 Modifier
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../modifier/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../modifier/introduction/" class="md-nav__link">
        方法介绍
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      <label class="md-nav__link" for="__nav_1_8">
        技术原理
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="技术原理" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          技术原理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../principle/recomposition_scope/" class="md-nav__link">
        了解Compose的重组作用域
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../principle/snapshot/" class="md-nav__link">
        透过Snapshot看重组
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../principle/gap_buffer/" class="md-nav__link">
        Compose运行原理与GapBuffer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../principle/recompose_working_principle/" class="md-nav__link">
        重组的工作流程
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../principle/modifier_structure/" class="md-nav__link">
        图解Modifier
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_9" type="checkbox" id="__nav_1_9" >
      
      <label class="md-nav__link" for="__nav_1_9">
        架构
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="架构" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_9">
          <span class="md-nav__icon md-icon"></span>
          架构
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/architecture_for_compose/" class="md-nav__link">
        Compose架构如何选？MVP,MVVM,MVI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/use_jetpack_in_compose/" class="md-nav__link">
        在 Compose 中使用 Jetpack 组件库
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../codelabs/" class="md-nav__link">
        代码实验室
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../resources/" class="md-nav__link">
        资源
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../version/" class="md-nav__link">
        版本更新迭代内容与介绍
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        关于贡献
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        第三方组件
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="第三方组件" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          第三方组件
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      <label class="md-nav__link" for="__nav_2_1">
        Accompanist
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Accompanist" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Accompanist
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/overview/" class="md-nav__link">
        概述
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/coil/" class="md-nav__link">
        Coil
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/glide/" class="md-nav__link">
        Glide
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/insets/" class="md-nav__link">
        Insets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/system_ui_controller/" class="md-nav__link">
        System UI Controller
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/appcompat_theme/" class="md-nav__link">
        AppCompat Theme
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/pager_layouts/" class="md-nav__link">
        Pager layouts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/swipe_refresh/" class="md-nav__link">
        Swipe Refresh
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/accompanist/flow_layouts/" class="md-nav__link">
        Flow layouts
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../third-party-component/shimmer/compose_shimmer/" class="md-nav__link">
        Compose版骨架屏
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        API 文档
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API 文档" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API 文档
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1">
        组件
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="组件" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          组件
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../api/elements/text/" class="md-nav__link">
        Text
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-materialtheme" class="md-nav__link">
    1. MaterialTheme 是怎么做到的
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-compositionlocal" class="md-nav__link">
    2. CompositionLocal介绍
  </a>
  
    <nav class="md-nav" aria-label="2. CompositionLocal介绍">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compositionlocalof-staticcompositionlocalof" class="md-nav__link">
    compositionLocalOf 与 staticCompositionLocalOf 区别
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Compose-Museum/Compose-Tutorial/tree/main/docs/design/theme/understanding_material_theme.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>深入理解 MaterialTheme 与 CompositionLocal</h1>
                
                <h2 id="1-materialtheme">1. MaterialTheme 是怎么做到的</h2>
<p>为深入理解 MaterialTheme 工作原理，我们需要进入源码一探究竟。</p>
<p><img src = "../../../assets/design/theme/understanding_material_theme/carbon.png" width = "90%" height = "50%"></p>
<p>需要注意的是，此时传入的 content 参数其实是声明在 Theme 中的自定义布局系统，其类型是一个带有 Composable 注解的 lambda (对于这类带有 Composable 的 lambda 简称为 composable )。</p>
<p>我们所关注的 colors 被 remember 修饰后赋值为 rememberedColors。如果 MaterialTheme 这个 composable 发生 recompose 时便会检查 colors 是否发生了改变从而决定更新。</p>
<p>接下来使用 CompositionLocalProvider 方法，通过中缀 providers 将 rememberedColors 提供给了 LocalColors。让我们回到自定义视图中，看看我们是如何通过 MaterialTheme 获取到当前主题配色的。</p>
<div class="highlight"><pre><span></span><code><span class="kd">object</span> <span class="nc">MaterialTheme</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="nv">colors</span><span class="p">:</span> <span class="n">Colors</span>
        <span class="nd">@Composable</span>
        <span class="nd">@ReadOnlyComposable</span>
        <span class="k">get</span><span class="p">()</span> <span class="o">=</span> <span class="n">LocalColors</span><span class="p">.</span><span class="na">current</span>
    <span class="kd">val</span> <span class="nv">typography</span><span class="p">:</span> <span class="n">Typography</span>
        <span class="nd">@Composable</span>
        <span class="nd">@ReadOnlyComposable</span>
        <span class="k">get</span><span class="p">()</span> <span class="o">=</span> <span class="n">LocalTypography</span><span class="p">.</span><span class="na">current</span>
    <span class="kd">val</span> <span class="nv">shapes</span><span class="p">:</span> <span class="n">Shapes</span>
        <span class="nd">@Composable</span>
        <span class="nd">@ReadOnlyComposable</span>
        <span class="k">get</span><span class="p">()</span> <span class="o">=</span> <span class="n">LocalShapes</span><span class="p">.</span><span class="na">current</span>
<span class="p">}</span>
</code></pre></div>
<p>可以发现在获取到当前主题配色时使用的是 MaterialTheme 类单例的 colors 属性，间接使用了 LocalColors。</p>
<p>总结来说，我们在自定义 Theme 使用的是 MaterialTheme 函数为 LocalColors 赋值，而在获取时使用的是 MaterialTheme 类单例，间接从 LocalColors 中获取到值。所以 LocalColors 到底是何方神圣呢？</p>
<div class="highlight"><pre><span></span><code><span class="kd">internal</span> <span class="kd">val</span> <span class="nv">LocalColors</span> <span class="o">=</span> <span class="n">staticCompositionLocalOf</span> <span class="p">{</span> <span class="n">lightColors</span><span class="p">()</span> <span class="p">}</span>
</code></pre></div>
<p>通过声明可以发现他实际上是一个 CompositionLocal，其初始值是 lightColors() 返回的 colors 配置。</p>
<p>MaterialTheme 方法中通过 CompositionLocalProvider 方法为我们的自定义视图 composable 提供了一些 CompositionLocal，包含了所有的主题配置信息。</p>
<h2 id="2-compositionlocal">2. CompositionLocal介绍</h2>
<p>很多时候我们需要在 composable 树中共享一些数据（例如主题配置），一种有效方式就是通过显式参数传递的方式进行实现，当参数越来越多时，composable 参数列表会变得越来越臃肿，难以进行维护。当 composable 需要彼此间传递数据，并且实现各自的私有性时，如果仍采用显式参数传递的方式则可能会产生意料之外的麻烦与崩溃。</p>
<p>为解决上述痛点问题， Jetpack Compose 提供了 CompostionLocal 用来完成 composable 树中共享数据方式。CompositionLocals 是具有层级的，可以被限定在以某个 composable 作为根结点的子树中，其默认会向下传递的，当然当前子树中的某个 composable 可以对该 CompositionLocals 进行覆盖，从而使得新值会在这个 composable 中继续向下传递。</p>
<p>Jetpack Compose 为我们提供了compositionLocalOf 方法用于创建一个 CompostionLocal 实例。</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">androidx.compose.runtime.compositionLocalOf</span>

<span class="kd">var</span> <span class="nv">LocalString</span> <span class="o">=</span> <span class="n">compositionLocalOf</span> <span class="p">{</span> <span class="s">&quot;Jetpack Compose&quot;</span> <span class="p">}</span>
</code></pre></div>
<p>在 composable 树的某个地方，我们可以使用 CompositionLocalProvider 方法为 CompositionLocal 提供一个值。通常情况下位于 composable 树的根部，但也可以位于任何位置，还可以在多个位置使用，以覆盖子树能够获取到的值。我们的示例选择在 Column 所包含的 composable 中使用 CompositionLocalProvider。</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span> <span class="nn">androidx.compose.runtime.CompositionLocalProvider</span>

<span class="n">setContent</span> <span class="p">{</span>
    <span class="n">CustomColorTheme</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Column</span> <span class="p">{</span>
            <span class="n">CompositionLocalProvider</span><span class="p">(</span>
                <span class="n">LocalString</span> <span class="n">provides</span> <span class="s">&quot;Hello World&quot;</span>
            <span class="p">)</span> <span class="p">{</span>
                <span class="n">Text</span><span class="p">(</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="n">LocalString</span><span class="p">.</span><span class="na">current</span><span class="p">,</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">.</span><span class="na">Green</span>
                <span class="p">)</span>
                <span class="n">CompositionLocalProvider</span><span class="p">(</span>
                    <span class="n">LocalString</span> <span class="n">provides</span> <span class="s">&quot;Ruger McCarthy&quot;</span>
                <span class="p">)</span> <span class="p">{</span>
                    <span class="n">Text</span><span class="p">(</span>
                        <span class="n">text</span> <span class="o">=</span> <span class="n">LocalString</span><span class="p">.</span><span class="na">current</span><span class="p">,</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">.</span><span class="na">Blue</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">Text</span><span class="p">(</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">LocalString</span><span class="p">.</span><span class="na">current</span><span class="p">,</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">.</span><span class="na">Red</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>实际效果可以看到，虽然所有 composable 均依赖的是同一个 CompositionLocal，而其获得到的实际的值却是不一样的。</p>
<p><img alt="demo1" src="../../../assets/design/theme/understanding_material_theme/demo1.png" /></p>
<h3 id="compositionlocalof-staticcompositionlocalof">compositionLocalOf 与 staticCompositionLocalOf 区别</h3>
<p>当我们创建  CompositionLocal 时，通常需要使用 <code>compositionLocalOf</code> 或 <code>staticCompositionLocalOf</code> 方法。然而这两者的区别是什么呢？其实<code>staticCompositionLocalOf</code> 方法声明处的注释文档中说明了一切。</p>
<blockquote>
<p>Unlike compositionLocalOf, reads of a staticCompositionLocalOf are not tracked by the composer and changing the value provided in the CompositionLocalProvider call will cause the entirety of the content to be recomposed instead of just the places where in the composition the local value is used.</p>
</blockquote>
<p>简单概括就是，当我们选择使用 <code>staticCompositionLocalOf</code> 时，实际上创建了个<code>StaticProvidableCompositionLocal</code> 实例，当其所提供的值改变时，会导致  CompositionLocalProvide 内部所有 composable 触发重组(recompose)。</p>
<p>如果我们选择使用 <code>compositionLocalOf</code>，实际上创建了个 <code>DynamicProvidableCompositionLocal</code> 实例，当其所提供的值改变时，仅会导致  CompositionLocalProvide 内部依赖当前 CompositionLocal 的 composable 触发重组(recompose)。</p>
<p>Talk is cheap，Show me the code~. 接下来我们进行对照示例印证。</p>
<p>既然要对照，我们就分别使用 <code>staticCompositionLocalOf</code> 与 <code>compositionLocalOf</code> 创建 CompositionLocal。我们使用三层嵌套的 Box 进行举例，我们将 CompositionLocalProvide 包裹在最外层，若某层 Box 触发了重组(recompose) 便会更新该层的文本信息。我们的示例中处于中层 的 Box 依赖了 CompositionLocal。</p>
<p>当我们修改了 CompositionLocal 所提供的值时，可以发现 <code>staticCompositionLocalOf</code> 场景下，所有 Box 均发生了重组，而 <code>DynamicCompositionLocal</code> 场景下，仅中层依赖了 CompositionLocal 的 Box 触发了重组。文章结尾处提供了实例代码。</p>
<p><img src="../../../assets/design/theme/understanding_material_theme/static.gif" width="40%" height = "40%"> <img src="../../../assets/design/theme/understanding_material_theme/dynamic.gif" width="40%" height = "40%"></p>
<p><strong>示例代码</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">var</span> <span class="nv">isStatic</span> <span class="o">=</span> <span class="kc">false</span>
<span class="kd">var</span> <span class="nv">compositionLocalName</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="kd">val</span> <span class="nv">currentLocalColor</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">isStatic</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">compositionLocalName</span> <span class="o">=</span> <span class="s">&quot;StaticCompositionLocal 场景&quot;</span>
    <span class="n">staticCompositionLocalOf</span> <span class="p">{</span> <span class="n">Color</span><span class="p">.</span><span class="na">Black</span> <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">compositionLocalName</span> <span class="o">=</span> <span class="s">&quot;DynamicCompositionLocal 场景&quot;</span>
    <span class="n">compositionLocalOf</span> <span class="p">{</span> <span class="n">Color</span><span class="p">.</span><span class="na">Black</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nv">recomposeFlag</span> <span class="o">=</span> <span class="s">&quot;Init&quot;</span>
<span class="nd">@Preview</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span> <span class="nf">CompositionLocalDemo</span><span class="p">(</span><span class="n">isStatic</span><span class="p">:</span> <span class="kt">Boolean</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">color</span> <span class="k">by</span> <span class="n">remember</span><span class="p">{</span> <span class="n">mutableStateOf</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Green</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">Box</span><span class="p">(</span>
        <span class="n">modifier</span> <span class="o">=</span> <span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
        <span class="n">contentAlignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="n">Column</span><span class="p">(</span><span class="n">horizontalAlignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">){</span>
            <span class="n">Text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">${</span><span class="n">compositionLocalName</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">Spacer</span> <span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>
            <span class="n">CompositionLocalProvider</span><span class="p">(</span>
                <span class="n">currentLocalColor</span> <span class="n">provides</span> <span class="n">color</span>
            <span class="p">)</span> <span class="p">{</span>
                <span class="n">TaggedBox</span><span class="p">(</span><span class="s">&quot;Wrapper: </span><span class="si">${</span><span class="n">recomposeFlag</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="m">400.</span><span class="n">dp</span><span class="p">,</span><span class="n">Color</span><span class="p">.</span><span class="na">Red</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">TaggedBox</span><span class="p">(</span><span class="s">&quot;Middle: </span><span class="si">${</span><span class="n">recomposeFlag</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="m">300.</span><span class="n">dp</span><span class="p">,</span> <span class="n">currentLocalColor</span><span class="p">.</span><span class="na">current</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">TaggedBox</span><span class="p">(</span><span class="s">&quot;Inner: </span><span class="si">${</span><span class="n">recomposeFlag</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span> <span class="m">200.</span><span class="n">dp</span><span class="p">,</span> <span class="n">Color</span><span class="p">.</span><span class="na">Yellow</span><span class="p">)</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">Spacer</span> <span class="p">(</span><span class="n">Modifier</span><span class="p">.</span><span class="na">height</span><span class="p">(</span><span class="m">20.</span><span class="n">dp</span><span class="p">))</span>
            <span class="n">Button</span><span class="p">(</span>
                <span class="n">onClick</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">.</span><span class="na">Blue</span>
                <span class="p">}</span>
            <span class="p">)</span> <span class="p">{</span>
                <span class="n">Text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Change Theme&quot;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">recomposeFlag</span> <span class="o">=</span> <span class="s">&quot;Recompose&quot;</span>
<span class="p">}</span>

<span class="nd">@Composable</span>
<span class="kd">fun</span> <span class="nf">TaggedBox</span><span class="p">(</span><span class="n">tag</span><span class="p">:</span><span class="kt">String</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Dp</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="n">Color</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nd">@Composable</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
    <span class="n">Column</span><span class="p">(</span>
        <span class="n">modifier</span> <span class="o">=</span> <span class="n">Modifier</span>
            <span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
            <span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">background</span><span class="p">),</span>
        <span class="n">horizontalAlignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">tag</span><span class="p">)</span>
        <span class="n">Box</span><span class="p">(</span>
            <span class="n">modifier</span> <span class="o">=</span> <span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
            <span class="n">contentAlignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">.</span><span class="na">Center</span>
        <span class="p">)</span> <span class="p">{</span>
            <span class="n">content</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 12, 2021</span>
      
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../meet_material_theme/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 初识 MaterialTheme" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              初识 MaterialTheme
            </div>
          </div>
        </a>
      
      
        
        <a href="../custom_your_theme/" class="md-footer__link md-footer__link--next" aria-label="下一页: 自定义你的主题方案" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              自定义你的主题方案
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/Compose-Museum/Compose-Tutorial/" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>