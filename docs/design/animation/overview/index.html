<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">æ¦‚è¿° | ä½ å¥½ Compose</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://milklab.dev/docs/design/animation/overview"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ¦‚è¿° | ä½ å¥½ Compose"><meta data-react-helmet="true" name="description" content="Jetpack Compose æä¾›äº†å¼ºå¤§çš„ã€å¯æ‰©å±•çš„ APIï¼Œä½¿å¾—åœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ä¸Šå®ç°å„ç§åŠ¨ç”»å˜å¾—æ›´å®¹æ˜“ã€‚æœ¬æ–‡æè¿°äº†å¦‚ä½•ä½¿ç”¨è¿™äº› APIï¼Œä»¥åŠæ ¹æ®ä½ çš„åŠ¨ç”»åœºæ™¯ä½¿ç”¨å“ªä¸ª APIã€‚"><meta data-react-helmet="true" property="og:description" content="Jetpack Compose æä¾›äº†å¼ºå¤§çš„ã€å¯æ‰©å±•çš„ APIï¼Œä½¿å¾—åœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ä¸Šå®ç°å„ç§åŠ¨ç”»å˜å¾—æ›´å®¹æ˜“ã€‚æœ¬æ–‡æè¿°äº†å¦‚ä½•ä½¿ç”¨è¿™äº› APIï¼Œä»¥åŠæ ¹æ®ä½ çš„åŠ¨ç”»åœºæ™¯ä½¿ç”¨å“ªä¸ª APIã€‚"><link data-react-helmet="true" rel="icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://milklab.dev/docs/design/animation/overview"><link data-react-helmet="true" rel="alternate" href="https://milklab.dev/docs/design/animation/overview" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://milklab.dev/docs/design/animation/overview" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8bcaa596.css">
<link rel="preload" href="/assets/js/runtime~main.882db5d6.js" as="script">
<link rel="preload" href="/assets/js/main.61b0141a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Jetpack Compose åšç‰©é¦†</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/docs/open-source-project/compose-douban">å¼€æºé¡¹ç›®</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/milklabdev/jetpack-compose-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ğŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ğŸŒ</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">å†™åœ¨å¼€å¤´</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/å…¥é—¨">å…¥é—¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;å…¥é—¨&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">å®‰è£…æˆ–æ›´æ–° Android Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial">åˆè¯† Jetpack Compose</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/elements/alertdialog">åŸºç¡€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/layout/box">å¸ƒå±€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" href="/docs/category/è®¾è®¡">è®¾è®¡</a><button aria-label="Toggle the collapsible sidebar category &#x27;è®¾è®¡&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/category/åŠ¨ç”»animation">åŠ¨ç”»ï¼ˆAnimationï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åŠ¨ç”»ï¼ˆAnimationï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/design/animation/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/animation/animationVisibility">AnimationVisibilityï¼ˆå®éªŒæ€§ï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/animation/animateAsState">Animate*AsState</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/animation/animatable">Animatable</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/animation/updateTransition">UpdateTranstion</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/ä¸»é¢˜theming">ä¸»é¢˜ï¼ˆThemingï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;ä¸»é¢˜ï¼ˆThemingï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/æ‰‹åŠ¿gesture">æ‰‹åŠ¿ï¼ˆGestureï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ‰‹åŠ¿ï¼ˆGestureï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/åˆ—è¡¨lists">åˆ—è¡¨ï¼ˆListsï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åˆ—è¡¨ï¼ˆListsï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/resources">èµ„æº</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/æŠ€æœ¯åŸç†">æŠ€æœ¯åŸç†</a><button aria-label="Toggle the collapsible sidebar category &#x27;æŠ€æœ¯åŸç†&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>æ¦‚è¿°</h1></header><p>Jetpack Compose æä¾›äº†å¼ºå¤§çš„ã€å¯æ‰©å±•çš„ APIï¼Œä½¿å¾—åœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ä¸Šå®ç°å„ç§åŠ¨ç”»å˜å¾—æ›´å®¹æ˜“ã€‚æœ¬æ–‡æè¿°äº†å¦‚ä½•ä½¿ç”¨è¿™äº› APIï¼Œä»¥åŠæ ¹æ®ä½ çš„åŠ¨ç”»åœºæ™¯ä½¿ç”¨å“ªä¸ª APIã€‚</p><p>åŠ¨ç”»åœ¨ç°ä»£ç§»åŠ¨åº”ç”¨ä¸­è‡³å…³é‡è¦ï¼Œå…¶ç›®çš„æ˜¯å®ç°è‡ªç„¶æµç•…ã€æ˜“äºç†è§£çš„ç”¨æˆ·ä½“éªŒã€‚è®¸å¤š Jetpack Compose åŠ¨ç”» API å¯ä»¥æä¾›å¯ç»„åˆå‡½æ•°ï¼Œå°±åƒå¸ƒå±€å’Œå…¶ä»–ç•Œé¢å…ƒç´ ä¸€æ ·ï¼›å®ƒä»¬ç”±ä½¿ç”¨ Kotlin åç¨‹æŒ‚èµ·å‡½æ•°æ„å»ºçš„è¾ƒä½çº§åˆ« API æä¾›æ”¯æŒã€‚æœ¬æŒ‡å—å°†é¦–å…ˆä»‹ç»å¯ç”¨äºè®¸å¤šå®é™…åœºæ™¯çš„é«˜çº§åˆ« APIï¼Œæ¥ç€ä»‹ç»å¯ä¸ºæ‚¨æä¾›è¿›ä¸€æ­¥æ§åˆ¶å’Œè‡ªå®šä¹‰åŠŸèƒ½çš„ä½çº§åˆ« APIã€‚</p><p>ä¸‹é¢çš„å›¾è¡¨å¯ä»¥å¸®åŠ©æ‚¨ç¡®å®šè¦ä½¿ç”¨å“ªç§ API æ¥å®ç°æ‚¨çš„åŠ¨ç”»æ•ˆæœã€‚</p><img src="/assets/images/demo-1fe6a47b026d0b639fa7ea62cf3669ba.png"><ul><li><p>å¦‚æœæ‚¨è¦ä¸ºå¸ƒå±€ä¸­çš„å†…å®¹å˜åŒ–æ·»åŠ åŠ¨ç”»æ•ˆæœï¼š</p><ul><li><p>å¦‚æœæ‚¨è¦ä¸ºè¿›å…¥/é€€å‡ºè¿‡æ¸¡æ·»åŠ åŠ¨ç”»æ•ˆæœï¼š</p><ul><li>ä½¿ç”¨ <code>AnimationVisibility</code>ã€‚</li></ul></li><li><p>å¦‚æœæ‚¨è¦ä¸ºå†…å®¹å¤§å°å˜åŒ–æ·»åŠ åŠ¨ç”»æ•ˆæœï¼š</p><ul><li>ä½¿ç”¨ <code>Modifier.animateContentSize</code>ã€‚</li></ul></li><li><p>å¦åˆ™ä½¿ç”¨ <code>Crossfade</code>ã€‚</p></li></ul></li><li><p>å¦‚æœåŠ¨ç”»æ•ˆæœåŸºäºçŠ¶æ€ï¼š</p><ul><li>å¦‚æœåœ¨ç»„åˆæœŸé—´å‘ˆç°åŠ¨ç”»æ•ˆæœï¼š<ul><li>å¦‚æœåŠ¨ç”»æ•ˆæœæ— é™å¾ªç¯ï¼š<ul><li>ä½¿ç”¨ <code>rememberInfiniteTransition</code>ã€‚</li></ul></li></ul></li></ul></li><li><p>å¦‚æœæ‚¨è¦åŒæ—¶ä¸ºå¤šä¸ªå€¼æ·»åŠ åŠ¨ç”»æ•ˆæœï¼š</p><ul><li>ä½¿ç”¨ <code>updateTransition</code>ã€‚</li><li>å¦åˆ™ä½¿ç”¨ <code>animate*AsState</code>ã€‚</li></ul></li><li><p>å¦‚æœæ‚¨è¦å¯¹åŠ¨ç”»æ’­æ”¾æ—¶é—´è¿›è¡Œç²¾ç»†æ§åˆ¶ï¼š</p><ul><li>ä½¿ç”¨ <code>Animation</code>ã€‚</li></ul></li><li><p>å¦‚æœåŠ¨ç”»æ˜¯å”¯ä¸€å¯ä¿¡æ¥æºï¼š</p><ul><li>ä½¿ç”¨ <code>Animatable</code>ã€‚</li><li>å¦åˆ™ï¼Œè¯·ä½¿ç”¨ <code>AnimationState</code> æˆ– <code>animate</code>ã€‚</li></ul></li></ul><table><thead><tr><th>API</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><strong><a href="/docs/design/animation/animationvisibility">AnimationVisibility</a></strong></td><td><strong>æ˜¾ç¤º/éšè—çš„è¿‡æ¸¡åŠ¨ç”»</strong></td></tr><tr><td><strong>Modifier.contentSize</strong></td><td><strong>å†…å®¹å¤§å°çš„å˜åŒ–è¿‡æ¸¡åŠ¨ç”»</strong></td></tr><tr><td><strong>Crossfade</strong></td><td></td></tr><tr><td><strong>rememberInfiniteTransition</strong></td><td></td></tr><tr><td><strong><a href="/docs/design/animation/updateTransition">updateTransition</a></strong></td><td><strong>å®ç°è¿‡æ¸¡åŠ¨ç”»çš„å…³é”® API</strong></td></tr><tr><td><strong><a href="/docs/design/animation/animateAsState">animate*AsState</a></strong></td><td><strong>æŒ‡å®šç±»å‹çš„æ•°æ®å˜åŒ–åŠ¨ç”»</strong></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-é«˜çº§åŠ¨ç”»-api">2. é«˜çº§åŠ¨ç”» API<a class="hash-link" href="#2-é«˜çº§åŠ¨ç”»-api" title="Direct link to heading">â€‹</a></h2><p><code>Compose</code> ä¸ºè®¸å¤šåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å‡ ç§å¸¸è§åŠ¨ç”»æ¨¡å¼æä¾›äº†é«˜çº§åŠ¨ç”» <code>API</code>ã€‚ è¿™äº› <code>API</code> æ˜¯ä¸ºé€‚åº” <a href="https://material.io/design/motion/" target="_blank" rel="noopener noreferrer">Material Design Motion</a> è€Œé‡èº«å®šåˆ¶çš„ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="animatedvisibiliy-å®éªŒæ€§">AnimatedVisibiliy (å®éªŒæ€§)<a class="hash-link" href="#animatedvisibiliy-å®éªŒæ€§" title="Direct link to heading">â€‹</a></h3><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>æ³¨æ„</h5></div><div class="admonition-content"><p>å®éªŒæ€§APIå°†æ¥å¯èƒ½ä¼šæ›´æ”¹ï¼Œæˆ–è€…å¯èƒ½ä¼šå®Œå…¨åˆ é™¤ã€‚</p></div></div><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// å¦‚æœä½ åœ¨è¿™é‡Œæœ‰ getValue çš„æŠ¥é”™ï¼Œæˆ–è€…æ— æ³•è‡ªåŠ¨å¯¼å…¥ï¼Œè¿™æ˜¯ä¸€äº›æ—§ç‰ˆ Android Studio è¿˜æ²¡æœ‰å®Œå…¨é€‚é… Compose çš„ bugã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä½ éœ€è¦æ‰‹åŠ¨å¯¼å…¥ï¼Œæˆ–è€…æ›´æ–°åˆ°æœ€æ–°çš„ AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// import androidx.compose.runtime.getValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var state by remember{ mutableStateOf(true) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .fillMaxSize(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    horizontalAlignment = Alignment.CenterHorizontally,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verticalArrangement = Arrangement.Center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AnimatedVisibility(visible = state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            text = &quot;è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„æ­£æ–‡&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fontWeight = FontWeight.W900,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            style = MaterialTheme.typography.h5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spacer(Modifier.padding(vertical = 50.dp))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Button(onClick = {state = !state}) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(if(state) &quot;éšè—&quot; else &quot;æ˜¾ç¤º&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é»˜è®¤æƒ…å†µä¸‹</p><p>å†…å®¹é€šè¿‡ <code>fadeIn()</code> å’Œ <code>expandVertically()</code> å‡ºç°</p><p>é€šè¿‡ <code>fadeOut()</code> å’Œ <code>shrinkVertically()</code> æ¶ˆå¤±ã€‚ä½ å¯ä»¥é€šè¿‡æŒ‡å®š <code>EnterTransition</code> å’Œ <code>ExitTransition</code> æ¥è‡ªå®šä¹‰è¿‡æ¸¡æ•ˆæœã€‚</p><img src="/assets/images/demo-28e07a821bd06d02f1c9700ed0215d7f.gif"><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var state by remember{ mutableStateOf(true) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Column(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .fillMaxSize(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    horizontalAlignment = Alignment.CenterHorizontally,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verticalArrangement = Arrangement.Center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AnimatedVisibility(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        visible = state,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        enter = slideInVertically(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            initialOffsetY = { -40 }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) + expandVertically(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            expandFrom = Alignment.Top</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) + fadeIn(initialAlpha = 0.3f),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        exit = shrinkHorizontally() + fadeOut()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            text = &quot;è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„æ­£æ–‡&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fontWeight = FontWeight.W900,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            style = MaterialTheme.typography.h5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Spacer(Modifier.padding(vertical = 50.dp))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Button(onClick = { state = !state }) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(if (state) &quot;éšè—&quot; else &quot;æ˜¾ç¤º&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo10-bcfc91c79b09a6054d6dca3d7dd38d3c.gif"><p>å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œä½ å¯ä»¥å°†å¤šä¸ª <code>EnterTransition</code> æˆ– <code>ExitTransition</code> å¯¹è±¡ä¸ä¸€ä¸ª <code>+</code> è¿ç®—ç¬¦ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”æ¯ä¸ªå¯¹è±¡éƒ½æ¥å—å¯é€‰å‚æ•°ä»¥è‡ªå®šä¹‰å…¶è¡Œä¸ºã€‚</p><p><code>EnterTransition</code> çš„ä¸€äº›æ–¹æ³•</p><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#fadeIn(kotlin.Float,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>fadeIn</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-fadein.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#slideIn(kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>slideIn</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slidein.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#expandIn(androidx.compose.ui.Alignment,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>expandIn</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-expandin.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#expandHorizontally(androidx.compose.ui.Alignment.Horizontal,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>expandHorizontally</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-expandhorizontally.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#expandVertically(androidx.compose.ui.Alignment.Vertical,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>expandVertically</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-expandvertically.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#slideInHorizontally(kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>slideInHorizontally</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slideinhorizontally.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#slideInVertically(kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>slideInVertically</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slideinvertically.gif" width="100" height="100"><p><code>ExitTransition</code> çš„ä¸€äº›æ–¹æ³•</p><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#fadeOut(kotlin.Float,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>fadeOut</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-fadeout.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#slideOut(kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>slideOut</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slideout.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#shrinkOut(androidx.compose.ui.Alignment,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>shrinkOut</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-shrinkout.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#shrinkHorizontally(androidx.compose.ui.Alignment.Horizontal,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>shrinkHorizontally</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-shrinkhorizontally.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#shrinkVertically(androidx.compose.ui.Alignment.Vertical,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>shrinkVertically</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-shrinkvertically.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#shrinkHorizontally(androidx.compose.ui.Alignment.Horizontal,kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec,kotlin.Boolean)" target="_blank" rel="noopener noreferrer"><code>slideOutHorizontally</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slideouthorizontally.gif" width="100" height="100"><p><a href="https://developer.android.com/reference/kotlin/androidx/compose/animation/package-summary#slideOutVertically(kotlin.Function1,androidx.compose.animation.core.FiniteAnimationSpec)" target="_blank" rel="noopener noreferrer"><code>slideOutVertically</code></a></p><img src="https://developer.android.com/images/jetpack/compose/animation-slideoutvertically.gif" width="100" height="100"><h3 class="anchor anchorWithStickyNavbar_mojV" id="animatecontentsize">animateContentSize<a class="hash-link" href="#animatecontentsize" title="Direct link to heading">â€‹</a></h3><p><code>animateContentSize</code> å¯ä»¥å¯¹å°ºå¯¸æ›´æ”¹è¿›è¡ŒåŠ¨ç”»å¤„ç†</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var text by remember{ mutableStateOf(&quot;animateContentSize åŠ¨ç”»&quot;) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier = Modifier.fillMaxSize(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    contentAlignment = Alignment.Center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Text(text, modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .clickable{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            text += text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .animateContentSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo-28e07a821bd06d02f1c9700ed0215d7f.gif"><p>å†æ¥çœ‹çœ‹æ²¡æœ‰åŠ  <code>animateContentSize()</code> çš„æ•ˆæœå§</p><img src="/assets/images/demo2-a8f66207f656f0590f2f0a0162536860.gif"><h3 class="anchor anchorWithStickyNavbar_mojV" id="crossfade">Crossfade<a class="hash-link" href="#crossfade" title="Direct link to heading">â€‹</a></h3><p><code>Crossfade</code> åœ¨ä¸¤ä¸ªå¸ƒå±€ä¹‹é—´ç”¨äº¤å‰æ·¡å…¥æ·¡å‡ºçš„åŠ¨ç”»ã€‚é€šè¿‡åˆ‡æ¢ä¼ é€’ç»™å½“å‰å‚æ•°çš„å€¼ï¼Œå†…å®¹ä»¥äº¤å‰æ¸å˜åŠ¨ç”»çš„æ–¹å¼åˆ‡æ¢</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun &lt;T&gt; Crossfade(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetState: T,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier: Modifier = Modifier,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec: FiniteAnimationSpec&lt;Float&gt; = tween(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content: @Composable (T) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ¥çœ‹çœ‹ä¸€ä¸ªç®€å•çš„ä½¿ç”¨</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var flag by remember{ mutableStateOf(false) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Column{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Crossfade(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         targetState = flag, animationSpec = tween(1000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when(it){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            false -&gt; Screen1()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            true -&gt; Screen2()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Button(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         onClick = { flag = !flag }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(&quot;åˆ‡æ¢&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun Screen1() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(200.dp),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        contentAlignment = Alignment.Center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun Screen2() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Blue)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(200.dp),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        contentAlignment = Alignment.Center</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo3-8792a2235904337fb6eab6657b5fddd3.gif"><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-ä½çº§åŠ¨ç”»-api">3. ä½çº§åŠ¨ç”» API<a class="hash-link" href="#3-ä½çº§åŠ¨ç”»-api" title="Direct link to heading">â€‹</a></h2><p>ä¸Šä¸€èŠ‚æåˆ°çš„æ‰€æœ‰é«˜çº§åŠ¨ç”» <code>API</code> éƒ½æ˜¯å»ºç«‹åœ¨ä½çº§åŠ¨ç”» <code>API</code> çš„åŸºç¡€ä¹‹ä¸Šçš„ã€‚</p><p><code>animate*AsState</code> å‡½æ•°æ˜¯æœ€ç®€å•çš„ <code>API</code>ï¼Œå®ƒå°†ä¸€ä¸ªå³æ—¶çš„å€¼å˜åŒ–æ¸²æŸ“æˆä¸€ä¸ªåŠ¨ç”»å€¼ã€‚å®ƒç”± <code>Animatable</code> æ”¯æŒï¼Œ<code>Animatable</code> æ˜¯ä¸€ä¸ªåŸºäºåç¨‹çš„ <code>API</code>ï¼Œç”¨äºç»™å•ä¸ªå€¼åˆ¶ä½œåŠ¨ç”»ã€‚<code>updateTransition</code> åˆ›å»ºäº†ä¸€ä¸ªè¿‡æ¸¡å¯¹è±¡ï¼Œå¯ä»¥ç®¡ç†å¤šä¸ªåŠ¨ç”»å€¼ï¼Œå¹¶æ ¹æ®çŠ¶æ€å˜åŒ–è¿è¡Œå®ƒä»¬ã€‚<code>rememberInfiniteTransition</code> ç±»ä¼¼ï¼Œä½†å®ƒåˆ›å»ºäº†ä¸€ä¸ªæ— é™çš„è¿‡æ¸¡ï¼Œå¯ä»¥ç®¡ç†å¤šä¸ªåŠ¨ç”»ï¼Œæ— é™åœ°æŒç»­è¿è¡Œã€‚é™¤äº† <code>Animatable</code> ä¹‹å¤–ï¼Œæ‰€æœ‰è¿™äº›<code>API</code> éƒ½æ˜¯å¯ç»„åˆçš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨åˆæˆä¹‹å¤–åˆ›å»ºè¿™äº›åŠ¨ç”»ã€‚</p><p>æ‰€æœ‰è¿™äº› <code>API</code> éƒ½æ˜¯åŸºäºæ›´åŸºæœ¬çš„ <code>Animation API</code>ã€‚å°½ç®¡å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸ä¼šç›´æ¥ä¸ <code>Animation</code> äº¤äº’ï¼Œä½† <code>Animation</code> çš„ä¸€äº›å®šåˆ¶åŠŸèƒ½å¯ä»¥é€šè¿‡æ›´é«˜çº§åˆ«çš„ <code>API</code> è·å¾—ã€‚å…³äº <code>AnimationVector</code> å’Œ <code>AnimationSpec</code> çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="/docs/design/animation/overview#4-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E7%94%BB">è‡ªå®šä¹‰åŠ¨ç”»</a>ã€‚</p><img><h3 class="anchor anchorWithStickyNavbar_mojV" id="animateasstate">animate*AsState<a class="hash-link" href="#animateasstate" title="Direct link to heading">â€‹</a></h3><p><code>animate*AsState</code> å‡½æ•°æ˜¯ <code>Compose</code> ä¸­æœ€ç®€å•çš„åŠ¨ç”» <code>API</code>ï¼Œç”¨äºä¸ºå•ä¸ªå€¼åˆ¶ä½œåŠ¨ç”»ã€‚ä½ åªéœ€æä¾›ç»“æŸå€¼ï¼ˆæˆ–ç›®æ ‡å€¼ï¼‰ï¼Œ<code>API</code> å°±ä¼šä»å½“å‰å€¼åˆ°æŒ‡å®šå€¼å¼€å§‹åŠ¨ç”»ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨è¿™ä¸ª <code>API</code> åˆ¶ä½œ <code>alpha</code> åŠ¨ç”»çš„ä¾‹å­ã€‚é€šè¿‡ç®€å•åœ°å°†ç›®æ ‡å€¼åŒ…è£¹åœ¨ <code>animateFloatAsState</code> ä¸­ï¼Œ<code>alpha</code> å€¼ç°åœ¨æ˜¯ä¸€ä¸ªä»‹äºæ‰€æä¾›çš„å€¼ï¼ˆæœ¬ä¾‹ä¸­æ˜¯ <code>1f</code> æˆ– <code>0.5f</code>ï¼‰ä¹‹é—´çš„åŠ¨ç”»å€¼ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val alpha: Float by animateFloatAsState(if (enabled) 1f else 0.5f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Modifier.fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .graphicsLayer(alpha = alpha)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .background(Color.Red)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>åœ¨è¿™é‡ŒæŸ¥çœ‹å…³äº <a href="/docs/design/animation/animateAsState"><code>animate*AsState</code></a> çš„æ›´å¤šä»‹ç»</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="animatable">Animatable<a class="hash-link" href="#animatable" title="Direct link to heading">â€‹</a></h3><p><code>Animatable</code> ä¼šåœ¨å†…éƒ¨å‚¨å­˜ä¸€ä¸ªå€¼ï¼Œå½“å€¼é€šè¿‡ <code>animateTo</code> è¢«æ”¹å˜æ—¶ï¼Œå®ƒå¯ä»¥äº§ç”ŸåŠ¨ç”»ã€‚è¿™å°±æ˜¯æ”¯æŒ <code>animate*AsState</code> å®ç°çš„ <code>API</code>ã€‚å®ƒç¡®ä¿äº†ä¸€è‡´çš„å»¶ç»­æ€§å’Œäº’æ–¥æ€§ï¼Œè¿™æ„å‘³ç€å€¼çš„å˜åŒ–æ€»æ˜¯è¿ç»­çš„ï¼Œä»»ä½•æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»éƒ½ä¼šè¢«å–æ¶ˆã€‚</p><p><code>Animatable</code> çš„è®¸å¤šåŠŸèƒ½ï¼ŒåŒ…æ‹¬ <code>animateTo</code>ï¼Œéƒ½æ˜¯ä½œä¸º <code>suspend</code> å‡½æ•°æä¾›çš„ã€‚è¿™æ„å‘³ç€å®ƒä»¬éœ€è¦è¢«åŒ…è£¹åœ¨ä¸€ä¸ªé€‚å½“çš„åç¨‹ä½œç”¨åŸŸå†…å†…ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>LaunchedEffect</code> è¿™ä¸ª <strong>Composable</strong> æ¥åˆ›å»ºä¸€ä¸ªåªé’ˆå¯¹æŒ‡å®šé”®å€¼çš„æŒç»­æ—¶é—´çš„ä½œç”¨åŸŸã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var flag by remember{ mutableStateOf(false) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val color = remember{ Animatable(Color.Gray) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Column{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(Modifier.size(300.dp).background(color.value))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Button(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         onClick = { flag = !flag }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Text(&quot;åˆ‡æ¢&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LaunchedEffect(flag) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    color.animateTo(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        targetValue = if (flag){ Color.Green } else { Color.Red },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        animationSpec = tween(1000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo4-8c1d4d1d7b5ded27836c59539133e1a3.gif"><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºå¹¶è®°ä½äº†ä¸€ä¸ª <code>Animatable</code> çš„å®ä¾‹ï¼Œå…¶åˆå§‹å€¼ä¸º <code>Color.Gray</code>ã€‚æ ¹æ® <code>flag</code> çš„å€¼ï¼Œé¢œè‰²ä¼šåŠ¨ç”»åœ°å˜æˆ <code>Color.Green</code> æˆ– <code>Color.Red</code>ã€‚ä»»ä½•å¯¹ <code>flag</code> çš„åç»­æ”¹å˜éƒ½ä¼šå¯åŠ¨åŠ¨ç”»åˆ°å¦ä¸€ç§é¢œè‰²ã€‚å¦‚æœåœ¨æ”¹å˜å€¼çš„æ—¶å€™æœ‰ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»ï¼Œé‚£ä¹ˆè¿™ä¸ªåŠ¨ç”»ä¼šè¢«å–æ¶ˆï¼Œæ–°çš„åŠ¨ç”»ä¼šä»å½“å‰çš„å¿«ç…§å€¼å’Œå½“å‰çš„é€Ÿåº¦å¼€å§‹ã€‚</p><p>è¿™æ˜¯æ”¯æŒä¸Šä¸€èŠ‚ä¸­æåˆ°çš„ <code>animate*AsState</code> <code>API</code> çš„åŠ¨ç”»å®ç°ã€‚ä¸ <code>animate*AsState</code> ç›¸æ¯”ï¼Œç›´æ¥ä½¿ç”¨ <code>Animatable</code> åœ¨å‡ ä¸ªæ–¹é¢ç»™äº†æˆ‘ä»¬æ›´ç²¾ç»†çš„æ§åˆ¶ã€‚é¦–å…ˆï¼Œ<code>Animatable</code> å¯ä»¥æœ‰ä¸€ä¸ªä¸åŒäºå…¶ç¬¬ä¸€ä¸ªç›®æ ‡å€¼çš„åˆå§‹å€¼ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢çš„ä»£ç ä¾‹å­ä¸€å¼€å§‹æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªç°è‰²çš„ç›’å­ï¼Œå½“è¿è¡Œç¨‹åºçš„æ—¶å€™ç«‹å³å¼€å§‹åŠ¨ç”»åœ°å˜æˆä¸ºç»¿è‰²æˆ–çº¢è‰²ã€‚ç¬¬äºŒï¼Œ<code>Animatable</code> å¯¹å†…å®¹å€¼æä¾›äº†æ›´å¤šçš„æ“ä½œï¼Œå³ <code>snapTo</code> å’Œ <code>animateDecay</code>ã€‚ <code>snapTo</code> å°†å½“å‰å€¼ç«‹å³è®¾ç½®ä¸ºç›®æ ‡å€¼ã€‚å½“åŠ¨ç”»æœ¬èº«ä¸æ˜¯å”¯ä¸€çš„æ•°æ®æºï¼Œå¹¶ä¸”å¿…é¡»ä¸å…¶ä»–çŠ¶æ€åŒæ­¥æ—¶ï¼Œä¾‹å¦‚è§¦æ‘¸äº‹ä»¶ï¼Œè¿™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ <code>animateDecay</code> å¯åŠ¨ä¸€ä¸ªä»ç»™å®šé€Ÿåº¦å¼€å§‹æ”¾ç¼“çš„åŠ¨ç”»ã€‚è¿™å¯¹äºå®ç°ç”©åŠ¨è¡Œä¸ºå¾ˆæœ‰ç”¨ã€‚æ›´å¤šä¿¡æ¯è§æ‰‹åŠ¿å’ŒåŠ¨ç”»ã€‚</p><p><code>Animatable</code> æ”¯æŒ <code>Float</code> å’Œ <code>Color</code>ï¼Œä½†ä»»ä½•æ•°æ®ç±»å‹éƒ½å¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ª <code>TwoWayConverter</code> æ¥ä½¿ç”¨ã€‚å‚è§ AnimationVector è·å–æ›´å¤šä¿¡æ¯ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ª <code>AnimationSpec</code> æ¥å®šåˆ¶åŠ¨ç”»è§„æ ¼ã€‚å‚è§ AnimationSpec è·å–æ›´å¤šä¿¡æ¯ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="updatetransition">updateTransition<a class="hash-link" href="#updatetransition" title="Direct link to heading">â€‹</a></h3><p><code>Transition</code> ç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ªåŠ¨ç”»ä½œä¸ºå®ƒçš„å­é¡¹ï¼Œå¹¶åœ¨å¤šä¸ªçŠ¶æ€ä¹‹é—´åŒæ—¶è¿è¡Œå®ƒä»¬ã€‚</p><p>è¿™äº›çŠ¶æ€å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„æšä¸¾ç±»å‹æ¥ç¡®ä¿ç±»å‹å®‰å…¨ï¼Œå°±åƒè¿™ä¸ªä¾‹å­ä¸­ä¸€æ ·ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">private enum class BoxState {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Collapsed,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Expanded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>updateTransition</code> å¯ä»¥åˆ›å»ºå¹¶è®°ä½ä¸€ä¸ª <code>Transition</code> çš„å®ä¾‹å¹¶æ›´æ–°å…¶çŠ¶æ€</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var currentState by remember { mutableStateOf(BoxState.Collapsed) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val transition = updateTransition(currentState)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>ç„¶åä½ å¯ä»¥ä½¿ç”¨ <code>animate*</code> æ‰©å±•å‡½æ•°ä¸­çš„ä¸€ä¸ªåœ¨è¿™ä¸ªè¿‡æ¸¡ä¸­å®šä¹‰ä¸€ä¸ªå­åŠ¨ç”»ã€‚æŒ‡å®šæ¯ä¸ªçŠ¶æ€çš„ç›®æ ‡å€¼ã€‚è¿™äº› <code>animate*</code> å‡½æ•°è¿”å›ä¸€ä¸ªåŠ¨ç”»å€¼ï¼Œåœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­ï¼Œå½“ç”¨ <code>updateTransition</code> æ›´æ–°è¿‡æ¸¡çŠ¶æ€æ—¶ï¼Œæ¯ä¸€å¸§éƒ½ä¼šæ›´æ–°ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var currentState by remember { mutableStateOf(BoxState.Collapsed) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val transition = updateTransition(currentState)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val rect by transition.animateDp { state -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    when (state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BoxState.Collapsed -&gt; 0.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BoxState.Expanded -&gt; 150.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .size(rect)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .background(Color(0xFF0079D3)),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo5-ccfa373a2ffc1f3eafc74ab48a9c9436.gif"><p>ä½ å¯ä»¥é€‰æ‹©ä¼ é€’ä¸€ä¸ª <code>transitionSpec</code> å‚æ•°ï¼Œä¸ºæ¯ä¸ªè¿‡æ¸¡çŠ¶æ€å˜åŒ–çš„ç»„åˆæŒ‡å®šä¸€ä¸ªä¸åŒçš„ <code>AnimationSpec</code>ã€‚å‚è§ <a href="https://developer.android.com/jetpack/compose/animation#animationspec" target="_blank" rel="noopener noreferrer">AnimationSpec</a> ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val rect by transition.animateDp(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transitionSpec = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BoxState.Expanded isTransitioningTo BoxState.Collapsed -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                spring(stiffness = 50f)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                tween(durationMillis = 500) // åŠ¨ç”»æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">){ state -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    when (state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BoxState.Collapsed -&gt; 0.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BoxState.Expanded -&gt; 150.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo6-5d4343178be7e057c40ef43febd92277.gif"><p>ä¸€æ—¦ä¸€ä¸ª <code>transition</code> åˆ°è¾¾ç›®æ ‡çŠ¶æ€ï¼Œ<code>Transition.currentState</code> å°†ä¸ <code>Transition.targetState</code> ç›¸åŒã€‚è¿™å¯ä»¥ä½œä¸ºè¿‡æ¸¡æ˜¯å¦å®Œæˆçš„ä¸€ä¸ªä¿¡å·ã€‚</p><p>æˆ‘ä»¬æœ‰æ—¶å¸Œæœ›æœ‰ä¸€ä¸ªä¸ç¬¬ä¸€ä¸ªç›®æ ‡çŠ¶æ€ä¸åŒçš„åˆå§‹çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>updateTransition</code> ä¸ <code>MutableTransitionState</code> æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ä»£ç è¿›å…¥åˆæˆæ—¶ç«‹å³å¼€å§‹åŠ¨ç”»ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">var currentState = remember { MutableTransitionState(BoxState.Collapsed) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åœ¨è¿è¡Œç¨‹åºæ—¶ï¼Œå°† currentState çš„å€¼å˜ä¸º BoxState.Expandedï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œå°†ä¼šç›´æ¥è¿è¡ŒåŠ¨ç”»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">currentState.targetState = BoxState.Expanded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val transition = updateTransition(currentState)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>å°è£…ä¸€ä¸ª Transition å¹¶è®©å®ƒå¯ä»¥é‡å¤ä½¿ç”¨</strong></p><p>å¯¹äºç®€å•çš„ç”¨ä¾‹ï¼Œåœ¨ä¸ä½ çš„ç”¨æˆ·ç•Œé¢ç›¸åŒçš„ <code>composable</code> ä¸­å®šä¹‰è¿‡æ¸¡åŠ¨ç”»æ˜¯ä¸€ä¸ªå®Œå…¨æœ‰æ•ˆçš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œå½“ä½ æ­£åœ¨å¤„ç†ä¸€ä¸ªæœ‰è®¸å¤šåŠ¨ç”»å€¼çš„å¤æ‚ç»„ä»¶æ—¶ï¼Œä½ å¯èƒ½æƒ³æŠŠåŠ¨ç”»å®ç°ä¸å¯ç»„åˆçš„ç”¨æˆ·ç•Œé¢åˆ†å¼€ã€‚</p><p>ä½ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæŒæœ‰æ‰€æœ‰åŠ¨ç”»å€¼çš„ç±»å’Œä¸€ä¸ªè¿”å›è¯¥ç±»å®ä¾‹çš„ &quot;æ›´æ–° &quot;å‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚è¿‡æ¸¡çš„å®ç°å¯ä»¥è¢«æå–åˆ°æ–°çš„ç‹¬ç«‹å‡½æ•°ä¸­ã€‚å½“éœ€è¦é›†ä¸­åŠ¨ç”»é€»è¾‘æˆ–ä½¿å¤æ‚çš„åŠ¨ç”»å¯é‡å¤ä½¿ç”¨æ—¶ï¼Œè¿™ç§æ¨¡å¼å¾ˆæœ‰ç”¨ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">enum class BoxState { Collapsed, Expanded }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun AnimatingBox(boxState: BoxState) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val transitionData = updateTransitionData(boxState)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // UI æ ‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(transitionData.color)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(transitionData.size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ä¿å­˜åŠ¨ç”»æ•°å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private class TransitionData(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    color: State&lt;Color&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    size: State&lt;Dp&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val color by color</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val size by size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// åˆ›å»ºä¸€ä¸ª Transition å¹¶è¿”å›å…¶åŠ¨ç”»å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private fun updateTransitionData(boxState: BoxState): TransitionData {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val transition = updateTransition(boxState)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val color = transition.animateColor { state -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when (state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BoxState.Collapsed -&gt; Color.Gray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BoxState.Expanded -&gt; Color.Red</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val size = transition.animateDp { state -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        when (state) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BoxState.Collapsed -&gt; 64.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            BoxState.Expanded -&gt; 128.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return remember(transition) { TransitionData(color, size) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="rememberinfinitetransition">rememberInfiniteTransition<a class="hash-link" href="#rememberinfinitetransition" title="Direct link to heading">â€‹</a></h3><p><code>InfiniteTransition</code> åƒ <code>Transition</code> ä¸€æ ·æŒæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­åŠ¨ç”»ï¼Œä½†è¿™äº›åŠ¨ç”»ä¸€è¿›å…¥æ„å›¾å°±å¼€å§‹è¿è¡Œï¼Œé™¤éå®ƒä»¬è¢«ç§»é™¤ï¼Œå¦åˆ™ä¸ä¼šåœæ­¢ã€‚ä½ å¯ä»¥ç”¨ <code>rememberInfiniteTransition</code> åˆ›å»ºä¸€ä¸ª <code>InfiniteTransition</code> çš„å®ä¾‹ã€‚å­åŠ¨ç”»å¯ä»¥ç”¨ <code>animateColor</code>ã€<code>animatedFloat</code> æˆ– <code>animatedValue</code> æ·»åŠ ã€‚ä½ è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ª <code>infiniteRepeatable</code> æ¥æŒ‡å®šåŠ¨ç”»å½¢å¼ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val infiniteTransition = rememberInfiniteTransition()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val color by infiniteTransition.animateColor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    initialValue = Color.Red, // åˆå§‹å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = Color.Green, // æœ€ç»ˆå€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = infiniteRepeatable(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        animation = tween(1000, easing = LinearEasing), // ä¸€ä¸ªåŠ¨ç”»å€¼çš„è½¬æ¢æŒç»­ 1 ç§’ï¼Œç¼“å’Œæ–¹å¼ä¸º LinearEasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        repeatMode = RepeatMode.Reverse </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // æŒ‡å®šåŠ¨ç”»é‡å¤è¿è¡Œçš„æ–¹å¼ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Reverse ä¸º init -&gt; target, target -&gt; init, init -&gt; target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Repeat ä¸º init -&gt; target, init -&gt; target, init -&gt; target</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Box(Modifier.fillMaxSize().background(color))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo7-3176fcf970b60feee96841c60a14b9a9.gif"><h3 class="anchor anchorWithStickyNavbar_mojV" id="targetbasedanimation">TargetBasedAnimation<a class="hash-link" href="#targetbasedanimation" title="Direct link to heading">â€‹</a></h3><p><code>TargetBasedAnimation</code> æ˜¯æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢çœ‹åˆ°çš„æœ€ä½çº§åˆ«çš„åŠ¨ç”» <code>API</code>ã€‚å…¶ä»– <code>API</code> æ¶µç›–äº†å¤§å¤šæ•°çš„ä½¿ç”¨æƒ…å†µï¼Œä½†ç›´æ¥ä½¿ç”¨ <code>TargetBasedAnimation</code> å¯ä»¥è®©ä½ è‡ªå·±æ§åˆ¶åŠ¨ç”»çš„æ’­æ”¾æ—¶é—´ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<code>TargetAnimation</code> çš„æ’­æ”¾æ—¶é—´æ˜¯æ ¹æ® <code>withFrameMillis</code> æä¾›çš„å¸§æ—¶é—´æ‰‹åŠ¨æ§åˆ¶çš„ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val anim = remember {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TargetBasedAnimation(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        animationSpec = tween(200),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        typeConverter = Float.VectorConverter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        initialValue = 200f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        targetValue = 1000f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var playTime by remember { mutableStateOf(0L) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LaunchedEffect(anim) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val startTime = withFrameNanos { it }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    do {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        playTime = withFrameNanos { it } - startTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val animationValue = anim.getValueFromNanos(playTime)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } while (someCustomCondition())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-è‡ªå®šä¹‰åŠ¨ç”»">4. è‡ªå®šä¹‰åŠ¨ç”»<a class="hash-link" href="#4-è‡ªå®šä¹‰åŠ¨ç”»" title="Direct link to heading">â€‹</a></h2><p>è®¸å¤šåŠ¨ç”» <code>API</code> é€šå¸¸æ¥å—å‚æ•°æ¥å®šåˆ¶å®ƒçš„è¡Œä¸ºã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="animationspec">AnimationSpec<a class="hash-link" href="#animationspec" title="Direct link to heading">â€‹</a></h3><p>å¤§å¤šæ•°åŠ¨ç”» <code>API</code> å…è®¸å¼€å‘è€…é€šè¿‡ä¸€ä¸ªå¯é€‰çš„ <code>AnimationSpec</code> å‚æ•°æ¥å®šåˆ¶åŠ¨ç”»è§„æ ¼ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val alpha: Float by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = if (enabled) 1f else 0.5f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // é…ç½®åŠ¨ç”»çš„æŒç»­æ—¶é—´å’Œç¼“å’Œåº¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = tween(durationMillis = 300, easing = FastOutSlowInEasing)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æœ‰ä¸åŒç§ç±»çš„ <code>AnimationSpec</code> ç”¨äºåˆ›å»ºä¸åŒç±»å‹çš„åŠ¨ç”»ã€‚</p><p><strong>spring</strong></p><p><code>spring</code> åœ¨èµ·å§‹å€¼å’Œç»“æŸå€¼ä¹‹é—´åˆ›å»ºä¸€ä¸ªåŸºäºç‰©ç†å­¦çš„åŠ¨ç”»ã€‚å®ƒéœ€è¦ <code>2</code> ä¸ªå‚æ•°ï¼šé˜»å°¼ç‡å’Œåˆšåº¦ã€‚</p><p><code>dampingRatio</code> å®šä¹‰äº†å¼¹ç°§çš„åå¼¹ç¨‹åº¦ã€‚é»˜è®¤å€¼æ˜¯ <code>Spring.DampingRatioNoBouncy</code>ã€‚</p><img src="/assets/images/animation-spring-c372b0c453dc981aac1380574fb0196f.gif"><p><code>stiffness</code> å®šä¹‰äº†å¼¹ç°§å‘æœ€ç»ˆå€¼ç§»åŠ¨çš„é€Ÿåº¦ã€‚é»˜è®¤å€¼æ˜¯ <code>Spring.StiffnessMedium</code>ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = spring(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dampingRatio = Spring.DampingRatioHighBouncy,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stiffness = Spring.StiffnessMedium</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>spring</code> å¯ä»¥æ¯”åŸºäºæŒç»­æ—¶é—´çš„ <code>AnimationSpec</code> ç±»å‹æ›´é¡ºåˆ©åœ°å¤„ç†ä¸­æ–­ï¼Œå› ä¸ºå®ƒä¿è¯äº†ç›®æ ‡å€¼åœ¨åŠ¨ç”»ä¸­å˜åŒ–æ—¶é€Ÿåº¦çš„è¿ç»­æ€§ã€‚ <code>spring</code> è¢«è®¸å¤šåŠ¨ç”» <code>API</code> ç”¨ä½œé»˜è®¤çš„ <code>AnimationSpec</code>ï¼Œå¦‚ <code>animate*AsState</code> å’Œ <code>updateTransition</code> ã€‚</p><p><strong>tween</strong></p><p><code>tween</code> åœ¨æŒ‡å®šçš„ <code>durationMillis</code> ä¸Šä½¿ç”¨ç¼“å’Œæ›²çº¿åœ¨å¼€å§‹å’Œç»“æŸå€¼ä¹‹é—´è¿›è¡ŒåŠ¨ç”»ã€‚æ›´å¤šä¿¡æ¯è¯·çœ‹ <a href="https://developer.android.com/jetpack/compose/animation#easing" target="_blank" rel="noopener noreferrer">Easing</a>ã€‚ä½ ä¹Ÿå¯ä»¥æŒ‡å®š <code>delayMillis</code> æ¥æ¨è¿ŸåŠ¨ç”»çš„å¼€å§‹æ—¶é—´ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = tween(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        durationMillis = 300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        delayMillis = 50,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        easing = LinearOutSlowInEasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>keyframes</strong></p><p><code>keyframes</code> çš„åŠ¨ç”»åŸºäºåŠ¨ç”»æŒç»­æ—¶é—´ä¸­ä¸åŒæ—¶é—´æˆ³æŒ‡å®šçš„å¿«ç…§å€¼ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼ŒåŠ¨ç”»å€¼å°†åœ¨ä¸¤ä¸ª <code>keyframes</code> å€¼ä¹‹é—´æ’å€¼ã€‚å¯¹äºè¿™äº› <code>keyframes</code> ä¸­çš„æ¯ä¸€ä¸ªï¼Œå¯ä»¥æŒ‡å®š <code>Easing</code> æ¥å†³å®šæ’å€¼æ›²çº¿ã€‚</p><p>æŒ‡å®š <code>0</code> æ¯«ç§’å¤„å’ŒæŒç»­æ—¶é—´å¤„çš„æ•°å€¼æ˜¯å¯é€‰çš„ã€‚å¦‚æœä½ ä¸æŒ‡å®šè¿™äº›å€¼ï¼Œå®ƒä»¬å°†åˆ†åˆ«é»˜è®¤ä¸ºåŠ¨ç”»çš„å¼€å§‹å’Œç»“æŸå€¼ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = keyframes {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        durationMillis = 375</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0.0f at 0 with LinearOutSlowInEasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0.2f at 15 with FastOutLinearInEasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0.4f at 75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        0.4f at 225</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>repeatable</strong></p><p><code>repeatable</code> é‡å¤è¿è¡Œä¸€ä¸ªåŸºäºæŒç»­æ—¶é—´çš„åŠ¨ç”»ï¼ˆæ¯”å¦‚ <code>Tween</code> æˆ–å…³é”®å¸§ï¼‰ï¼Œç›´åˆ°å®ƒè¾¾åˆ°æŒ‡å®šçš„è¿­ä»£æ¬¡æ•°ã€‚ä½ å¯ä»¥é€šè¿‡ <code>repeatMode</code> å‚æ•°æ¥æŒ‡å®šåŠ¨ç”»æ˜¯å¦åº”è¯¥ä»å¼€å§‹ <code>RepeatMode.Restart</code> æˆ–ä»ç»“æŸ <code>RepeatMode.Reverse</code> å¼€å§‹é‡å¤ã€‚</p><p><strong>infiniteRepeatable</strong></p><p><code>infiniteRepeatable</code> å’Œ <code>repeatable</code> ä¸€æ ·ï¼Œä½†å®ƒä¼šé‡å¤æ— é™æ¬¡çš„è¿­ä»£ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = infiniteRepeatable(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        animation = tween(durationMillis = 300),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        repeatMode = RepeatMode.Reverse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>åœ¨ä½¿ç”¨ <code>ComposeTestRule</code> çš„æµ‹è¯•ä¸­ï¼Œä½¿ç”¨ <code>infiniteRepeatable</code> çš„åŠ¨ç”»ä¸ä¼šè¢«è¿è¡Œã€‚è¯¥ç»„ä»¶å°†ä½¿ç”¨æ¯ä¸ªåŠ¨ç”»å€¼çš„åˆå§‹å€¼è¿›è¡Œæ¸²æŸ“ã€‚</p><p><strong>snap</strong></p><p><code>snap</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ <code>AnimationSpec</code>ï¼Œå¯ä»¥ç«‹å³å°†å€¼åˆ‡æ¢åˆ°ç»“æŸå€¼ã€‚ä½ å¯ä»¥æŒ‡å®š <code>delayMillis</code>ï¼Œä»¥ä¾¿å»¶è¿ŸåŠ¨ç”»çš„å¼€å§‹ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    animationSpec = snap(delayMillis = 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>æ³¨æ„</h5></div><div class="admonition-content"><p>åœ¨ <code>View UI</code> ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>ObjectAnimator</code> ç­‰æ¥å®ç°åŸºäºæ—¶é—´çš„åŠ¨ç”»ï¼Œè€Œ <code>SpringAnimation</code> åˆ™æ˜¯åŸºäºç‰©ç†çš„åŠ¨ç”»ã€‚è¦åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªä¸åŒçš„åŠ¨ç”» <code>API</code> å¹¶ä¸å®¹æ˜“ã€‚<code>Compose</code> ä¸­çš„ <code>AnimationSpec</code> å…è®¸æˆ‘ä»¬ä»¥ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥å¤„ç†è¿™äº›ã€‚</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="easing">Easing<a class="hash-link" href="#easing" title="Direct link to heading">â€‹</a></h3><p>åŸºäºæŒç»­æ—¶é—´çš„ <code>AnimationSpec</code> æ“ä½œï¼ˆå¦‚ <code>tween</code> æˆ– <code>keyframes</code>ï¼‰ä½¿ç”¨ <code>Easing</code> æ¥è°ƒæ•´åŠ¨ç”»çš„åˆ†æ•°ã€‚è¿™å…è®¸åŠ¨ç”»å€¼åŠ é€Ÿå’Œå‡é€Ÿï¼Œè€Œä¸æ˜¯ä»¥ä¸€ä¸ªæ’å®šçš„é€Ÿåº¦ç§»åŠ¨ã€‚åˆ†æ•°æ˜¯ä¸€ä¸ªä»‹äº <code>0</code>ï¼ˆå¼€å§‹ï¼‰å’Œ <code>1.0</code>ï¼ˆç»“æŸï¼‰ä¹‹é—´çš„æ•°å€¼ï¼Œè¡¨ç¤ºåŠ¨ç”»çš„å½“å‰ç‚¹ã€‚</p><p><code>Easing</code> å®é™…ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªä»‹äº <code>0</code> å’Œ <code>1.0</code> ä¹‹é—´çš„åˆ†æ•°å€¼å¹¶è¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚è¿”å›çš„å€¼å¯ä»¥åœ¨è¾¹ç•Œä¹‹å¤–ï¼Œä»¥è¡¨ç¤ºè¿‡å†²æˆ–ä¸‹å†²çš„æƒ…å†µã€‚ä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>Easing</code> å¯ä»¥åƒä¸‹é¢çš„ä»£ç ä¸€æ ·è¢«åˆ›å»ºã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val CustomEasing = Easing { fraction -&gt; fraction * fraction }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun EasingUsage() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val value by animateFloatAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        targetValue = 1f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        animationSpec = tween(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            durationMillis = 300,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            easing = CustomEasing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // â€¦ â€¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>Compose</code> æä¾›äº†å‡ ä¸ªå†…ç½®çš„ <code>Easing</code> åŠŸèƒ½ï¼Œæ¶µç›–äº†å¤§å¤šæ•°ä½¿ç”¨æƒ…å†µã€‚è¯·å‚é˜… <a href="https://material.io/design/motion/speed.html#easing" target="_blank" rel="noopener noreferrer">Speed Material Design</a>ï¼Œäº†è§£æ›´å¤šå…³äºæ ¹æ®ä½ çš„æƒ…å†µä½¿ç”¨ä½•ç§ <code>Easing</code> çš„ä¿¡æ¯ã€‚</p><ul><li>FastOutSlowInEasing</li><li>LinearOutSlowInEasing</li><li>FastOutLinearEasing</li><li>LinearEasing</li><li>CubicBezierEasing</li></ul><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>æ³¨æ„</h5></div><div class="admonition-content"><p> <code>Easing</code> å¯¹è±¡çš„å·¥ä½œæ–¹å¼ä¸å¹³å°ä¸­ <code>Interpolator</code> ç±»çš„å®ä¾‹ç›¸åŒã€‚å®ƒæ²¡æœ‰ <code>getInterpolation()</code> æ–¹æ³•ï¼Œè€Œæ˜¯æœ‰ <code>transform()</code> æ–¹æ³•ã€‚</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="animationvector">AnimationVector<a class="hash-link" href="#animationvector" title="Direct link to heading">â€‹</a></h3><p>å¤§å¤šæ•° <code>Compose</code> çš„åŠ¨ç”» <code>API</code> éƒ½æ”¯æŒ <code>Float</code>ã€<code>Color</code>ã€<code>Dp</code> å’Œå…¶ä»–åŸºæœ¬æ•°æ®ç±»å‹ä½œä¸ºå¼€ç®±å³ç”¨çš„åŠ¨ç”»å€¼ï¼Œä½†ä½ æœ‰æ—¶éœ€è¦å¯¹å…¶ä»–æ•°æ®ç±»å‹è¿›è¡ŒåŠ¨ç”»å¤„ç†ï¼ŒåŒ…æ‹¬ä½ è‡ªå®šä¹‰çš„æ•°æ®ã€‚åœ¨åŠ¨ç”»åˆ¶ä½œè¿‡ç¨‹ä¸­ï¼Œä»»ä½•åŠ¨ç”»å€¼éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª <code>AnimationVector</code>ã€‚è¯¥å€¼é€šè¿‡ç›¸åº”çš„ <code>TwoWayConverter</code> è½¬æ¢ä¸º <code>AnimationVector</code>ï¼Œåä¹‹äº¦ç„¶ï¼Œè¿™æ ·æ ¸å¿ƒåŠ¨ç”»ç³»ç»Ÿå°±å¯ä»¥ç»Ÿä¸€å¤„ç†å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª <code>Int</code> è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª <code>AnimationVector1D</code>ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªæµ®ç‚¹å€¼ã€‚<code>Int</code> çš„ <code>TwoWayConverter</code> çœ‹èµ·æ¥åƒè¿™æ ·ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">val IntToVector: TwoWayConverter&lt;Int, AnimationVector1D&gt; =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TwoWayConverter({ AnimationVector1D(it.toFloat()) }, { it.value.toInt() })</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é¢œè‰²æœ¬è´¨ä¸Šæ˜¯ä¸€ç»„ <code>4</code> ä¸ªå€¼ï¼Œçº¢ã€ç»¿ã€è“å’Œé€æ˜åº¦ï¼Œæ‰€ä»¥é¢œè‰²è¢«è½¬æ¢ä¸ºä¸€ä¸ª <code>AnimationVector4D</code>ï¼ŒæŒæœ‰ <code>4</code> ä¸ªæµ®ç‚¹å€¼ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒåŠ¨ç”»ä¸­ä½¿ç”¨çš„æ¯ä¸€ç§æ•°æ®ç±»å‹éƒ½è¢«è½¬æ¢ä¸º <code>AnimationVector1D</code>ã€<code>AnimationVector2D</code>ã€<code>AnimationVector3D</code> æˆ– <code>AnimationVector4D</code>ï¼Œå–å†³äºå…¶ç»´åº¦ã€‚è¿™ä½¿å¾—å¯¹è±¡çš„ä¸åŒç»„ä»¶å¯ä»¥ç‹¬ç«‹åœ°è¢«åŠ¨ç”»åŒ–ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„é€Ÿåº¦è·Ÿè¸ªã€‚åŸºæœ¬æ•°æ®ç±»å‹çš„å†…ç½®è½¬æ¢å™¨å¯ä»¥ä½¿ç”¨ <code>Color.VectorConverter</code>ã€<code>Dp</code>ã€<code>VectorConverter</code> ç­‰è®¿é—®ã€‚</p><p>å½“ä½ æƒ³æ·»åŠ å¯¹ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ä½œä¸ºåŠ¨ç”»å€¼çš„æ”¯æŒæ—¶ï¼Œä½ å¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„ <code>TwoWayConverter</code> å¹¶å°†å…¶æä¾›ç»™ <code>API</code>ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>animateValueAsState</code> æ¥ä½¿ä½ çš„è‡ªå®šä¹‰æ•°æ®ç±»å‹äº§ç”ŸåŠ¨ç”»ï¼Œåƒè¿™æ ·ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">data class MySize(val width: Dp, val height: Dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun MyAnimation(targetSize: MySize) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val animSize: MySize by animateValueAsState&lt;MySize, AnimationVector2D&gt;(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        targetSize,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TwoWayConverter(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            convertToVector = { size: MySize -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // ä»æ¯ä¸ª Dp å­—æ®µä¸­æå–ä¸€ä¸ªæµ®åŠ¨å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AnimationVector2D(size.width.value, size.height.value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            convertFromVector = { vector: AnimationVector2D -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                MySize(vector.v1.dp, vector.v2.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="5-æ‰‹åŠ¿ä¸åŠ¨ç”»é«˜çº§">5. æ‰‹åŠ¿ä¸åŠ¨ç”»ï¼ˆé«˜çº§ï¼‰<a class="hash-link" href="#5-æ‰‹åŠ¿ä¸åŠ¨ç”»é«˜çº§" title="Direct link to heading">â€‹</a></h2><p>ä¸å•ç‹¬å¤„ç†åŠ¨ç”»ç›¸æ¯”ï¼Œå½“æˆ‘ä»¬å¤„ç†è§¦æ‘¸äº‹ä»¶å’ŒåŠ¨ç”»æ—¶ï¼Œæœ‰å‡ ä»¶äº‹æˆ‘ä»¬å¿…é¡»è€ƒè™‘åˆ°ã€‚é¦–å…ˆï¼Œå½“è§¦æ‘¸äº‹ä»¶å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ä¸­æ–­æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»ï¼Œå› ä¸ºç”¨æˆ·äº’åŠ¨åº”è¯¥æœ‰æœ€é«˜çš„ä¼˜å…ˆæƒã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ª <code>Animatable</code> æ¥è¡¨ç¤ºä¸€ä¸ªåœ†å½¢ç»„ä»¶çš„åç§»ä½ç½®ã€‚è§¦æ‘¸äº‹ä»¶æ˜¯ç”¨ <code>pointerInput</code> ä¿®æ”¹å™¨æ¥å¤„ç†çš„ã€‚å½“æˆ‘ä»¬æ£€æµ‹åˆ°ä¸€ä¸ªæ–°çš„è½»æ•²äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>animateTo</code> æ¥å°†åç§»å€¼åŠ¨ç”»åŒ–åˆ°è½»æ•²ä½ç½®ã€‚æ•²å‡»äº‹ä»¶ä¹Ÿå¯ä»¥åœ¨åŠ¨ç”»ä¸­å‘ç”Ÿï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>animateTo</code> ä¸­æ–­æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»ï¼Œå¹¶å¼€å§‹åŠ¨ç”»åˆ°æ–°çš„ç›®æ ‡ä½ç½®ï¼ŒåŒæ—¶ä¿æŒä¸­æ–­çš„åŠ¨ç”»çš„é€Ÿåº¦ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun Gesture() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val offset = remember { Animatable(Offset(0f, 0f), Offset.VectorConverter) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                coroutineScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æ£€æµ‹ä¸€ä¸ªç‚¹å‡»å¤´äº‹ä»¶å¹¶è·å¾—å…¶ä½ç½®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        val position = awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            awaitFirstDown().position</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            // åº”ç”¨åˆ°ç‚¹å‡»çš„ä½ç½®ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            offset.animateTo(position)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Circle(modifier = Modifier.offset { offset.value.toIntOffset() })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private fun Offset.toIntOffset() = IntOffset(x.roundToInt(), y.roundToInt())</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo8-3f8af31951ea84127aecf27dc538ae39.gif"><p>å¦ä¸€ä¸ªå¸¸è§çš„æ¨¡å¼æ˜¯æˆ‘ä»¬éœ€è¦å°†åŠ¨ç”»å€¼ä¸æ¥è‡ªè§¦æ‘¸äº‹ä»¶çš„å€¼åŒæ­¥ï¼Œä¾‹å¦‚æ‹–åŠ¨ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° &quot;è½»æ‰«è§£æ•£&quot; ä½œä¸ºä¸€ä¸ªä¿®æ”¹å™¨æ¥å®ç°ï¼ˆè€Œä¸æ˜¯ä½¿ç”¨ <code>SwipeToDismiss</code> çš„ç»„åˆï¼‰ã€‚è¯¥å…ƒç´ çš„æ°´å¹³åç§»è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª<code>Animatable</code>ã€‚è¿™ä¸ª <code>API</code> æœ‰ä¸€ä¸ªåœ¨æ‰‹åŠ¿åŠ¨ç”»ä¸­æœ‰ç”¨çš„ç‰¹æ€§ã€‚å®ƒçš„å€¼å¯ä»¥è¢«è§¦æ‘¸äº‹ä»¶ä»¥åŠåŠ¨ç”»æ‰€æ”¹å˜ã€‚å½“æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ <code>stop</code> æ–¹æ³•åœæ­¢ <code>Animatable</code>ï¼Œè¿™æ ·ä»»ä½•æ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»å°±è¢«æ‹¦æˆªäº†ã€‚</p><p>åœ¨ä¸€ä¸ªæ‹–åŠ¨äº‹ä»¶ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>snapTo</code> æ¥æ›´æ–° <code>Animatable</code> çš„å€¼ï¼Œå³ä»è§¦æ‘¸äº‹ä»¶ä¸­è®¡ç®—å‡ºæ¥çš„å€¼ã€‚å¯¹äºæ‹–åŠ¨ï¼Œ<code>compose</code> æä¾›äº† <code>VelocityTracker</code> æ¥è®°å½•æ‹–åŠ¨äº‹ä»¶å¹¶è®¡ç®—å‡ºé€Ÿåº¦ã€‚é€Ÿåº¦å¯ä»¥ç›´æ¥åé¦ˆç»™<code>animateDecay</code>ï¼Œç”¨äºåˆ¶ä½œç¿»è½¬åŠ¨ç”»ã€‚å½“æˆ‘ä»¬æƒ³æŠŠåç§»å€¼æ»‘å›åˆ°åŸå§‹ä½ç½®æ—¶ï¼Œæˆ‘ä»¬ç”¨ <code>animateTo</code> æ–¹æ³•æŒ‡å®šç›®æ ‡åç§»å€¼ä¸º <code>0f</code>ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">fun Modifier.swipeToDismiss(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDismissed: () -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Modifier = composed {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val offsetX = remember { Animatable(0f) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val decay = splineBasedDecay&lt;Float&gt;(this)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        coroutineScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // æ£€æµ‹ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                val pointerId = awaitPointerEventScope { awaitFirstDown().id }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                val velocityTracker = VelocityTracker()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // æ‹¦æˆªä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„åŠ¨ç”»ï¼ˆå¦‚æœæœ‰çš„è¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                offsetX.stop()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    horizontalDrag(pointerId) { change -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // ç”¨è§¦æ‘¸äº‹ä»¶æ›´æ–°åŠ¨ç”»å€¼ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            offsetX.snapTo(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                offsetX.value + change.positionChange().x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        velocityTracker.addPosition(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            change.uptimeMillis,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            change.position</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                val velocity = velocityTracker.calculateVelocity().x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                val targetOffsetX = decay.calculateTargetValue(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    offsetX.value,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    velocity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // å½“å®ƒåˆ°è¾¾è¾¹ç•Œæ—¶ï¼ŒåŠ¨ç”»åœæ­¢ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                offsetX.updateBounds(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    lowerBound = -size.width.toFloat(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    upperBound = size.width.toFloat()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                launch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (targetOffsetX.absoluteValue &lt;= size.width) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // é€Ÿåº¦ä¸å¤Ÿï¼›å‘åæ»‘åŠ¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        offsetX.animateTo(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            targetValue = 0f,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            initialVelocity = velocity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // è¯¥å…ƒç´ è¢«åˆ·æ‰äº†ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        offsetX.animateDecay(velocity, decay)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        onDismissed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .offset { IntOffset(offsetX.value.roundToInt(), 0) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><img src="/assets/images/demo9-8a3cdf25bdfb789d6f93534f74644c45.gif"><h2 class="anchor anchorWithStickyNavbar_mojV" id="6-æµ‹è¯•">6. æµ‹è¯•<a class="hash-link" href="#6-æµ‹è¯•" title="Direct link to heading">â€‹</a></h2><p><code>Compose</code> æä¾›äº† <code>ComposeTestRule</code>ï¼Œå…è®¸ä½ ä»¥ç¡®å®šçš„æ–¹å¼ä¸ºåŠ¨ç”»ç¼–å†™æµ‹è¯•ï¼Œå¹¶å¯¹æµ‹è¯•æ—¶é’Ÿè¿›è¡Œå®Œå…¨æ§åˆ¶ã€‚è¿™ä½¿ä½ å¯ä»¥éªŒè¯ä¸­é—´çš„åŠ¨ç”»å€¼ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªæµ‹è¯•å¯ä»¥æ¯”åŠ¨ç”»çš„å®é™…æŒç»­æ—¶é—´æ›´å¿«è¿è¡Œã€‚</p><p><code>ComposeTestRule</code> å°†å…¶æµ‹è¯•æ—¶é’Ÿå…¬å¼€ä¸º <code>mainClock</code>ã€‚ä½ å¯ä»¥å°† <code>autoAdvance</code> å±æ€§è®¾ç½®ä¸º <code>false</code> æ¥æ§åˆ¶ä½ æµ‹è¯•ä»£ç ä¸­çš„æ—¶é’Ÿã€‚åœ¨å¯åŠ¨ä½ è¦æµ‹è¯•çš„åŠ¨ç”»åï¼Œæ—¶é’Ÿå¯ä»¥ç”¨ <code>advanceTimeBy</code> å‘å‰ç§»åŠ¨ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<code>advanceTimeBy</code> å¹¶ä¸å®Œå…¨æŒ‰ç…§æŒ‡å®šçš„æŒç»­æ—¶é—´æ¥ç§»åŠ¨æ—¶é’Ÿã€‚ç›¸åï¼Œå®ƒå°†å…¶å››èˆäº”å…¥åˆ°æœ€è¿‘çš„æŒç»­æ—¶é—´ï¼Œå³å¸§æŒç»­æ—¶é—´çš„ä¹˜æ•°ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@get:Rule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val rule = createComposeRule()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun testAnimationWithClock() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æš‚åœåŠ¨ç”»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rule.mainClock.autoAdvance = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var enabled by mutableStateOf(false)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rule.setContent {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val color by animateColorAsState(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            targetValue = if (enabled) Color.Red else Color.Green,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            animationSpec = tween(durationMillis = 250)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier.size(64.dp).background(color))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¯åŠ¨åŠ¨ç”»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è®©åŠ¨ç”»ç»§ç»­è¿›è¡Œã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rule.mainClock.advanceTimeBy(50L)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å°†ç»“æœä¸æ˜¾ç¤ºé¢„æœŸç»“æœçš„å›¾åƒè¿›è¡Œæ¯”è¾ƒã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rule.onRoot().captureToImage().assertAgainstGolden()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/milklabdev/jetpack-compose-book/tree/master/docs/design/animation/overview.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/category/åŠ¨ç”»animation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">åŠ¨ç”»ï¼ˆAnimationï¼‰</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/design/animation/animationVisibility"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AnimationVisibilityï¼ˆå®éªŒæ€§ï¼‰</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#2-é«˜çº§åŠ¨ç”»-api" class="table-of-contents__link toc-highlight">2. é«˜çº§åŠ¨ç”» API</a><ul><li><a href="#animatedvisibiliy-å®éªŒæ€§" class="table-of-contents__link toc-highlight">AnimatedVisibiliy (å®éªŒæ€§)</a></li><li><a href="#animatecontentsize" class="table-of-contents__link toc-highlight">animateContentSize</a></li><li><a href="#crossfade" class="table-of-contents__link toc-highlight">Crossfade</a></li></ul></li><li><a href="#3-ä½çº§åŠ¨ç”»-api" class="table-of-contents__link toc-highlight">3. ä½çº§åŠ¨ç”» API</a><ul><li><a href="#animateasstate" class="table-of-contents__link toc-highlight">animate*AsState</a></li><li><a href="#animatable" class="table-of-contents__link toc-highlight">Animatable</a></li><li><a href="#updatetransition" class="table-of-contents__link toc-highlight">updateTransition</a></li><li><a href="#rememberinfinitetransition" class="table-of-contents__link toc-highlight">rememberInfiniteTransition</a></li><li><a href="#targetbasedanimation" class="table-of-contents__link toc-highlight">TargetBasedAnimation</a></li></ul></li><li><a href="#4-è‡ªå®šä¹‰åŠ¨ç”»" class="table-of-contents__link toc-highlight">4. è‡ªå®šä¹‰åŠ¨ç”»</a><ul><li><a href="#animationspec" class="table-of-contents__link toc-highlight">AnimationSpec</a></li><li><a href="#easing" class="table-of-contents__link toc-highlight">Easing</a></li><li><a href="#animationvector" class="table-of-contents__link toc-highlight">AnimationVector</a></li></ul></li><li><a href="#5-æ‰‹åŠ¿ä¸åŠ¨ç”»é«˜çº§" class="table-of-contents__link toc-highlight">5. æ‰‹åŠ¿ä¸åŠ¨ç”»ï¼ˆé«˜çº§ï¼‰</a></li><li><a href="#6-æµ‹è¯•" class="table-of-contents__link toc-highlight">6. æµ‹è¯•</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/milklabdev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Milk Lab, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.882db5d6.js"></script>
<script src="/assets/js/main.61b0141a.js"></script>
</body>
</html>