<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">è‡ªå®šä¹‰è§¦æ‘¸åé¦ˆ | ä½ å¥½ Compose</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://milklab.dev/docs/design/gesture/customGesture"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="è‡ªå®šä¹‰è§¦æ‘¸åé¦ˆ | ä½ å¥½ Compose"><meta data-react-helmet="true" name="description" content="Jetpack Compose ä¸ºæˆ‘ä»¬æä¾›äº†è®¸å¤šæ‰‹åŠ¿å¤„ç† Modifierï¼Œå¯¹äºå¸¸è§ä¸šåŠ¡éœ€æ±‚æ¥è¯´å·²è¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨äº†ï¼Œç„¶è€Œå¦‚æœè¯´æˆ‘ä»¬å¯¹æ‰‹åŠ¿æœ‰å®šåˆ¶éœ€æ±‚ï¼Œå°±éœ€è¦å…·å¤‡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„èƒ½åŠ›äº†ã€‚é€šè¿‡ä½¿ç”¨å®˜æ–¹æ‰€æä¾›çš„åŸºç¡€ API æ¥å®Œæˆå„ç±»æ‰‹åŠ¿äº¤äº’éœ€æ±‚ï¼Œè§¦æ‘¸åé¦ˆåŸºç¡€ API ç±»ä¼¼ä¼ ç»Ÿ View ç³»ç»Ÿçš„ onTouchEvent()ã€‚ å½“ç„¶ Compose ä¸­ä¹Ÿæ”¯æŒç±»ä¼¼ä¼ ç»Ÿ ViewGroup é€šè¿‡ onInterceptTouchEvent()å®šåˆ¶æ‰‹åŠ¿äº‹ä»¶åˆ†å‘æµç¨‹ã€‚é€šè¿‡å¯¹è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„å­¦ä¹ å°†å¸®åŠ©å¤§å®¶æŒæ¡å¤„ç†ç»å¤§å¤šæ•°åœºæ™¯ä¸‹æ‰‹åŠ¿éœ€æ±‚çš„èƒ½åŠ›ã€‚"><meta data-react-helmet="true" property="og:description" content="Jetpack Compose ä¸ºæˆ‘ä»¬æä¾›äº†è®¸å¤šæ‰‹åŠ¿å¤„ç† Modifierï¼Œå¯¹äºå¸¸è§ä¸šåŠ¡éœ€æ±‚æ¥è¯´å·²è¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨äº†ï¼Œç„¶è€Œå¦‚æœè¯´æˆ‘ä»¬å¯¹æ‰‹åŠ¿æœ‰å®šåˆ¶éœ€æ±‚ï¼Œå°±éœ€è¦å…·å¤‡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„èƒ½åŠ›äº†ã€‚é€šè¿‡ä½¿ç”¨å®˜æ–¹æ‰€æä¾›çš„åŸºç¡€ API æ¥å®Œæˆå„ç±»æ‰‹åŠ¿äº¤äº’éœ€æ±‚ï¼Œè§¦æ‘¸åé¦ˆåŸºç¡€ API ç±»ä¼¼ä¼ ç»Ÿ View ç³»ç»Ÿçš„ onTouchEvent()ã€‚ å½“ç„¶ Compose ä¸­ä¹Ÿæ”¯æŒç±»ä¼¼ä¼ ç»Ÿ ViewGroup é€šè¿‡ onInterceptTouchEvent()å®šåˆ¶æ‰‹åŠ¿äº‹ä»¶åˆ†å‘æµç¨‹ã€‚é€šè¿‡å¯¹è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„å­¦ä¹ å°†å¸®åŠ©å¤§å®¶æŒæ¡å¤„ç†ç»å¤§å¤šæ•°åœºæ™¯ä¸‹æ‰‹åŠ¿éœ€æ±‚çš„èƒ½åŠ›ã€‚"><link data-react-helmet="true" rel="icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://milklab.dev/docs/design/gesture/customGesture"><link data-react-helmet="true" rel="alternate" href="https://milklab.dev/docs/design/gesture/customGesture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://milklab.dev/docs/design/gesture/customGesture" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.cba56bc1.css">
<link rel="preload" href="/assets/js/runtime~main.279986bd.js" as="script">
<link rel="preload" href="/assets/js/main.387f3f8c.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Jetpack Compose åšç‰©é¦†</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/docs/open-source-project/compose-douban">å¼€æºé¡¹ç›®</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/milklabdev/jetpack-compose-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ğŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ğŸŒ</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">å†™åœ¨å¼€å¤´</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/å…¥é—¨">å…¥é—¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;å…¥é—¨&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">å®‰è£…æˆ–æ›´æ–° Android Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial">åˆè¯† Jetpack Compose</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/elements/alertdialog">åŸºç¡€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/layout/box">å¸ƒå±€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" href="/docs/category/è®¾è®¡">è®¾è®¡</a><button aria-label="Toggle the collapsible sidebar category &#x27;è®¾è®¡&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/åŠ¨ç”»animation">åŠ¨ç”»ï¼ˆAnimationï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åŠ¨ç”»ï¼ˆAnimationï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/ä¸»é¢˜theming">ä¸»é¢˜ï¼ˆThemingï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;ä¸»é¢˜ï¼ˆThemingï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" tabindex="0" href="/docs/category/æ‰‹åŠ¿gesture">æ‰‹åŠ¿ï¼ˆGestureï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ‰‹åŠ¿ï¼ˆGestureï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/gesture/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/gesture/draggable">æ‹–åŠ¨ï¼ˆDraggableï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/gesture/swipeable">æ»‘åŠ¨ï¼ˆSwipeableï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/gesture/transformer">åŒæŒ‡æ‹–åŠ¨ã€ç¼©æ”¾ä¸æ—‹è½¬ï¼ˆTransformerï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/design/gesture/nestedScroll">åµŒå¥—æ»‘åŠ¨ï¼ˆnestedScrollï¼‰</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/design/gesture/customGesture">è‡ªå®šä¹‰è§¦æ‘¸åé¦ˆ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/åˆ—è¡¨lists">åˆ—è¡¨ï¼ˆListsï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åˆ—è¡¨ï¼ˆListsï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/å›¾å½¢graphics">å›¾å½¢ï¼ˆGraphicsï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;å›¾å½¢ï¼ˆGraphicsï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/resources">èµ„æº</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/æŠ€æœ¯åŸç†">æŠ€æœ¯åŸç†</a><button aria-label="Toggle the collapsible sidebar category &#x27;æŠ€æœ¯åŸç†&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>è‡ªå®šä¹‰è§¦æ‘¸åé¦ˆ</h1></header><p>Jetpack Compose ä¸ºæˆ‘ä»¬æä¾›äº†è®¸å¤šæ‰‹åŠ¿å¤„ç† Modifierï¼Œå¯¹äºå¸¸è§ä¸šåŠ¡éœ€æ±‚æ¥è¯´å·²è¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨äº†ï¼Œç„¶è€Œå¦‚æœè¯´æˆ‘ä»¬å¯¹æ‰‹åŠ¿æœ‰å®šåˆ¶éœ€æ±‚ï¼Œå°±éœ€è¦å…·å¤‡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„èƒ½åŠ›äº†ã€‚é€šè¿‡ä½¿ç”¨å®˜æ–¹æ‰€æä¾›çš„åŸºç¡€ API æ¥å®Œæˆå„ç±»æ‰‹åŠ¿äº¤äº’éœ€æ±‚ï¼Œè§¦æ‘¸åé¦ˆåŸºç¡€ API ç±»ä¼¼ä¼ ç»Ÿ View ç³»ç»Ÿçš„ <code>onTouchEvent()</code>ã€‚ å½“ç„¶ Compose ä¸­ä¹Ÿæ”¯æŒç±»ä¼¼ä¼ ç»Ÿ ViewGroup é€šè¿‡ <code>onInterceptTouchEvent()</code>å®šåˆ¶æ‰‹åŠ¿äº‹ä»¶åˆ†å‘æµç¨‹ã€‚é€šè¿‡å¯¹è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†çš„å­¦ä¹ å°†å¸®åŠ©å¤§å®¶æŒæ¡å¤„ç†ç»å¤§å¤šæ•°åœºæ™¯ä¸‹æ‰‹åŠ¿éœ€æ±‚çš„èƒ½åŠ›ã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="ä½¿ç”¨-pointerinput-modifier">ä½¿ç”¨ PointerInput Modifier<a class="hash-link" href="#ä½¿ç”¨-pointerinput-modifier" title="Direct link to heading">â€‹</a></h2><p>å¯¹äºæ‰€æœ‰æ‰‹åŠ¿æ“ä½œçš„å¤„ç†éƒ½éœ€è¦å°è£…åœ¨è¿™ä¸ª Modifier ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ Modifier æ˜¯ç”¨æ¥ä¿®é¥° UI ç»„ä»¶çš„ï¼Œæ‰€ä»¥å°†æ‰‹åŠ¿æ“ä½œçš„å¤„ç†å°è£…åœ¨ Modifier ç¬¦åˆå¼€å‘è€…è®¾è®¡ç›´è§‰ï¼Œè¿™åŒæ—¶ä¹Ÿåšåˆ°äº†æ‰‹åŠ¿å¤„ç†é€»è¾‘ä¸ UI è§†å›¾çš„è§£è€¦ï¼Œä»è€Œæé«˜å¤ç”¨æ€§ã€‚</p><p>é€šè¿‡ç¿»é˜… <code>Swipeable Modifier</code> ã€<code>Draggable Modifier </code> ä»¥åŠ <code>Transformer Modifier</code>ï¼Œæˆ‘ä»¬éƒ½èƒ½çœ‹åˆ° <code>PointerInput Modifier</code> çš„èº«å½±ã€‚å› ä¸ºè¿™ç±»ä¸Šå±‚çš„æ‰‹åŠ¿å¤„ç† Modifier å…¶å®éƒ½æ˜¯åŸºäºè¿™ä¸ªåŸºç¡€ Modifier å®ç°çš„ã€‚æ‰€ä»¥æ—¢ç„¶è¦è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æµç¨‹ï¼Œè‡ªå®šä¹‰é€»è¾‘ä¹Ÿå¿…ç„¶è¦åœ¨è¿™ä¸ª Modifier ä¸­è¿›è¡Œå®ç°ã€‚</p><p>é€šè¿‡ <code>PointerInput Modifier</code> å®ç°æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬æ‰€å®šä¹‰çš„è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æµç¨‹å‡å‘ç”Ÿåœ¨ <code>PointerInputScope</code> ä¸­ï¼Œsuspend å…³é”®å­—ä¹Ÿå‘ŠçŸ¥æˆ‘ä»¬è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æµç¨‹æ˜¯å‘ç”Ÿåœ¨åç¨‹ä¸­ã€‚è¿™å…¶å®æ˜¯æ— å¯åšéçš„ï¼Œåœ¨æ¢ç´¢é‡ç»„å·¥ä½œåŸç†çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¹Ÿç»å¸¸èƒ½å¤Ÿçœ‹åˆ°åç¨‹çš„èº«å½±ã€‚ä¼´éšç€è¶Šæ¥è¶Šå¤šçš„ä¸»æµå¼€å‘æŠ€æœ¯æ‹¥æŠ±åç¨‹ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€åç¨‹æˆäº† Android å¼€å‘è€…æœªæ¥å¿…é¡»æŒæ¡çš„æŠ€èƒ½ã€‚æ¨å¹¿åç¨‹åŒæ—¶å…¶å®ä¹Ÿæ˜¯åœ¨æ¨å¹¿ Kotlinï¼Œå³ä½¿å®˜æ–¹ä¸€ç›´å¼ºè°ƒä¸ä¼šæ”¾å¼ƒ Javaï¼Œç„¶è€Œè°åˆä¼šåœ¨ Java ä¸­ä½¿ç”¨ Kotlin åç¨‹å‘¢ï¼Ÿ </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">fun Modifier.pointerInput(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vararg keys: Any?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block: suspend PointerInputScope.() -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): Modifier = composed(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    remember(density) { SuspendingPointerInputFilter(viewConfiguration, density) }.apply {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LaunchedEffect(this, *keys) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            block()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹çœ‹ <code>PointerInputScope</code> ä½œç”¨åŸŸä¸­ï¼Œä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å“ªäº› API æ¥å¤„ç†æ‰‹åŠ¿äº¤äº’ã€‚æœ¬æ–‡å°†ä¼šæ ¹æ®æ‰‹åŠ¿èƒ½åŠ›åˆ†ç±»è¿›è¡Œè§£é‡Šè¯´æ˜ã€‚</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ‹–åŠ¨ç±»å‹åŸºç¡€-api">æ‹–åŠ¨ç±»å‹åŸºç¡€ API<a class="hash-link" href="#æ‹–åŠ¨ç±»å‹åŸºç¡€-api" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="api-ä»‹ç»">API ä»‹ç»<a class="hash-link" href="#api-ä»‹ç»" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>APIåç§°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>detectDragGestures</td><td>ç›‘å¬æ‹–åŠ¨æ‰‹åŠ¿</td></tr><tr><td>detectDragGesturesAfterLongPress</td><td>ç›‘å¬é•¿æŒ‰åçš„æ‹–åŠ¨æ‰‹åŠ¿</td></tr><tr><td>detectHorizontalDragGestures</td><td>ç›‘å¬æ°´å¹³æ‹–åŠ¨æ‰‹åŠ¿</td></tr><tr><td>detectVerticalDragGestures</td><td>ç›‘å¬å‚ç›´æ‹–åŠ¨æ‰‹åŠ¿</td></tr></tbody></table><p>è°ˆåŠæ‹–åŠ¨ï¼Œè®¸å¤šäººç¬¬ä¸€ä¸ªååº”å°±æ˜¯ <code>Draggable Modifier</code>ï¼Œå› ä¸º <code>Draggable Modifier</code> ä¸ºæˆ‘ä»¬æä¾›äº†ç›‘å¬ UI ç»„ä»¶æ‹–åŠ¨èƒ½åŠ›ã€‚ç„¶è€Œ <code>Draggable Modifier</code> åœ¨æä¾›äº†ç›‘å¬ UI ç»„ä»¶æ‹–åŠ¨èƒ½åŠ›çš„åŒæ—¶ä¹Ÿæ‹“å±•å¢åŠ å…¶ä»–åŠŸèƒ½ï¼Œæˆ‘ä»¬é€šè¿‡ <code>Draggable Modifier</code> å‚æ•°åˆ—è¡¨å³å¯çœ‹å‡ºã€‚ä¾‹å¦‚é€šè¿‡ä½¿ç”¨ <code>DraggableState</code> å…è®¸å¼€å‘è€…æ ¹æ®éœ€æ±‚ä½¿ UI ç»„ä»¶è‡ªåŠ¨è¢«æ‹–åŠ¨ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">fun Modifier.draggable(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state: DraggableState,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    orientation: Orientation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: Boolean = true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interactionSource: MutableInteractionSource? = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    startDragImmediately: Boolean = false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragStarted: suspend CoroutineScope.(startedPosition: Offset) -&gt; Unit = {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragStopped: suspend CoroutineScope.(velocity: Float) -&gt; Unit = {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reverseDirection: Boolean = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æˆ‘ä»¬ä¸Šé¢æ‰€ç½—åˆ—çš„è¿™äº›æ‹–åŠ¨ API åªæä¾›äº†ç›‘å¬ UI ç»„ä»¶æ‹–åŠ¨çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€æ±‚ä¸ºå…¶æ‹“å±•åŠŸèƒ½ï¼Œè¿™ä¹Ÿæ˜¯è¿™äº›APIæ‰€å­˜åœ¨çš„æ„ä¹‰ã€‚æˆ‘ä»¬ä»å­—é¢ä¸Šå°±å¯ä»¥çœ‹å‡ºæ¯ä¸ª API æ‰€å¯¹åº”çš„å«ä¹‰ï¼Œç”±äºè¿™äº›APIçš„åŠŸèƒ½ä¸å‚æ•°ç›¸è¿‘ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…ä»¥ <code>detectDragGestures</code> ä½œä¸ºä¸¾ä¾‹è¯´æ˜ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="ä¸¾ä¾‹è¯´æ˜">ä¸¾ä¾‹è¯´æ˜<a class="hash-link" href="#ä¸¾ä¾‹è¯´æ˜" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å®Œæˆä¸€ä¸ªç»¿è‰²æ–¹å—çš„æ‰‹åŠ¿æ‹–åŠ¨ã€‚åœ¨ <code>Draggabel Modifier</code> ä¸­æˆ‘ä»¬è¿˜åªèƒ½ç›‘å¬å‚ç›´æˆ–æ°´å¹³ä¸­æŸä¸€ä¸ªæ–¹å‘çš„æ‰‹åŠ¿æ‹–åŠ¨ï¼Œè€Œä½¿ç”¨ <code>detectDragGestures</code> æ‰€æœ‰æ‰‹åŠ¿ä¿¡æ¯éƒ½æ˜¯å¯ä»¥æ‹¿åˆ°çš„ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ˜¯åªå¸Œæœ›æ‹¿åˆ°æŸä¸€ä¸ªæ–¹å‘çš„æ‰‹åŠ¿æ‹–åŠ¨ï¼Œä½¿ç”¨ <code>detectHorizontalDragGestures</code>  æˆ– <code>detectVerticalDragGestures</code> å³å¯ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>detectDragGestures</code> å¹¶ä¸”å¿½ç•¥æ‰æŸä¸ªæ–¹å‘çš„æ‰‹åŠ¿ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨é•¿æŒ‰åæ‰èƒ½æ‹¿åˆ°æ‰‹åŠ¿ä¿¡æ¯å¯ä»¥ä½¿ç”¨ <code>detectDragGesturesAfterLongPress</code>ã€‚</p><p><code>detectDragGestures</code> æä¾›äº†å››ä¸ªå‚æ•°ã€‚</p><p>onDragStart (å¯é€‰)ï¼šæ‹–åŠ¨å¼€å§‹æ—¶å›è°ƒ</p><p>onDragEnd (å¯é€‰)ï¼šæ‹–åŠ¨ç»“æŸæ—¶å›è°ƒ</p><p>onDragCancel (å¯é€‰)ï¼šæ‹–åŠ¨å–æ¶ˆæ—¶å›è°ƒ</p><p>onDrag (å¿…é¡»)ï¼šæ‹–åŠ¨æ—¶å›è°ƒ</p><p><code>decectDragGestures</code> çš„æºç åˆ†æåœ¨ <em>awaitTouchSlopOrCancellation</em> å°èŠ‚ä¼šæœ‰è®²è§£ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun PointerInputScope.detectDragGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragStart: (Offset) -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragEnd: () -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragCancel: () -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDrag: (change: PointerInputChange, dragAmount: Offset) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>ğŸ’¡ <strong>Tips </strong></p><p>æœ‰äº›åŒå­¦å¯èƒ½å›°æƒ‘ <code>onDragCancel</code> è§¦å‘æ—¶æœºã€‚åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œå½“ç»„ä»¶æ‹–åŠ¨æ—¶ä¼šæ ¹æ®äº‹ä»¶åˆ†å‘é¡ºåºè¿›è¡Œäº‹ä»¶åˆ†å‘ï¼Œå½“å‰é¢å…ˆå¤„ç†äº‹ä»¶çš„ç»„ä»¶æ»¡è¶³äº†è®¾ç½®çš„æ¶ˆè´¹æ¡ä»¶ï¼Œå¯¼è‡´æ‰‹åŠ¿äº‹ä»¶è¢«æ¶ˆè´¹ï¼Œå¯¼è‡´æœ¬ç»„ä»¶æ‹¿åˆ°çš„æ˜¯è¢«æ¶ˆè´¹çš„æ‰‹åŠ¿äº‹ä»¶ï¼Œä»è€Œä¼šæ‰§è¡Œ <code>onDragCancel</code> å›è°ƒã€‚å¦‚ä½•å®šåˆ¶äº‹ä»¶åˆ†å‘é¡ºåºå¹¶æ¶ˆè´¹äº‹ä»¶åç»­ä¼šè¿›è¡Œè¯¦ç»†çš„æè¿°ã€‚</p></blockquote><p>ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun DragGestureDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var boxSize = 100.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var offset by remember { mutableStateOf(Offset.Zero) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier.fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(boxSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .offset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                IntOffset(offset.x.roundToInt(), offset.y.roundToInt())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                detectDragGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDragStart = { offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æ‹–åŠ¨å¼€å§‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDragEnd = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æ‹–åŠ¨ç»“æŸ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDragCancel = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æ‹–åŠ¨å–æ¶ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDrag = { change: PointerInputChange, dragAmount: Offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æ‹–åŠ¨æ—¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        offset += dragAmount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div align="center"><img src="/assets/images/drag-80a95888973e3f8aff22b90304b4086d.gif" width="50%" height="50%"></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ç‚¹å‡»ç±»å‹åŸºç¡€-api">ç‚¹å‡»ç±»å‹åŸºç¡€ API<a class="hash-link" href="#ç‚¹å‡»ç±»å‹åŸºç¡€-api" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="api-ä»‹ç»-1">API ä»‹ç»<a class="hash-link" href="#api-ä»‹ç»-1" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>APIåç§°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>detectTapGestures</td><td>ç›‘å¬ç‚¹å‡»æ‰‹åŠ¿</td></tr></tbody></table><p>ä¸ <code>Clickable Modifier</code> ä¸åŒçš„æ˜¯ï¼Œ<code>detectTapGestures</code> å¯ä»¥ç›‘å¬æ›´å¤šçš„ç‚¹å‡»äº‹ä»¶ã€‚ä½œä¸ºæ‰‹æœºç›‘å¬çš„åŸºç¡€ APIï¼Œå¿…ç„¶ä¸ä¼šå­˜åœ¨ <code>Clickable Modifier</code> æ‰€æ‹“å±•çš„æ¶Ÿæ¼ªæ•ˆæœã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="ä¸¾ä¾‹è¯´æ˜-1">ä¸¾ä¾‹è¯´æ˜<a class="hash-link" href="#ä¸¾ä¾‹è¯´æ˜-1" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¸ºä¸€ä¸ªç»¿è‰²æ–¹å—æ·»åŠ ç‚¹å‡»æ‰‹åŠ¿å¤„ç†é€»è¾‘ã€‚<code>detectTapGestures</code> æä¾›äº†å››ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨æ¥ç›‘å¬ä¸åŒç‚¹å‡»äº‹ä»¶ã€‚</p><p>onDoubleTap (å¯é€‰)ï¼šåŒå‡»æ—¶å›è°ƒ</p><p>onLongPress (å¯é€‰)ï¼šé•¿æŒ‰æ—¶å›è°ƒ</p><p>onPress (å¯é€‰)ï¼šæŒ‰ä¸‹æ—¶å›è°ƒ</p><p>onTap (å¯é€‰)ï¼šè½»è§¦æ—¶å›è°ƒ</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun PointerInputScope.detectTapGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDoubleTap: ((Offset) -&gt; Unit)? = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onLongPress: ((Offset) -&gt; Unit)? = null,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onPress: suspend PressGestureScope.(Offset) -&gt; Unit = NoPressGesture,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onTap: ((Offset) -&gt; Unit)? = null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>ğŸ’¡ <strong>Tips </strong> </p><p>onPress æ™®é€šæŒ‰ä¸‹äº‹ä»¶</p><p>onDoubleTap å‰å¿…å®šä¼šå…ˆå›è°ƒ 2 æ¬¡ Press</p><p>onLongPress å‰å¿…å®šä¼šå…ˆå›è°ƒ 1 æ¬¡ Pressï¼ˆæ—¶é—´é•¿ï¼‰</p><p>onTap å‰å¿…å®šä¼šå…ˆå›è°ƒ 1 æ¬¡ Pressï¼ˆæ—¶é—´çŸ­ï¼‰</p></blockquote><p>ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤º</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TapGestureDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var boxSize = 100.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(boxSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                detectTapGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDoubleTap = { offset: Offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // åŒå‡»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onLongPress = { offset: Offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // é•¿æŒ‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onPress = {  offset: Offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // æŒ‰ä¸‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onTap = {  offset: Offset -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // è½»è§¦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="å˜æ¢ç±»å‹åŸºç¡€-api">å˜æ¢ç±»å‹åŸºç¡€ API<a class="hash-link" href="#å˜æ¢ç±»å‹åŸºç¡€-api" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="api-ä»‹ç»-2">API ä»‹ç»<a class="hash-link" href="#api-ä»‹ç»-2" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>APIåç§°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>detectTransformGestures</td><td>ç›‘å¬æ‹–åŠ¨ã€ç¼©æ”¾ä¸æ—‹è½¬æ‰‹åŠ¿</td></tr></tbody></table><p>ä¸ <code>Transfomer Modifier</code> ä¸åŒçš„æ˜¯ï¼Œé€šè¿‡è¿™ä¸ª API å¯ä»¥ç›‘å¬å•æŒ‡çš„æ‹–åŠ¨æ‰‹åŠ¿ï¼Œå’Œæ‹–åŠ¨ç±»å‹åŸºç¡€ APIæ‰€æä¾›çš„åŠŸèƒ½ä¸€æ ·ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æ”¯æŒç›‘å¬åŒæŒ‡ç¼©æ”¾ä¸æ—‹è½¬æ‰‹åŠ¿ã€‚åè§‚<code>Transfomer Modifier</code> åªèƒ½ç›‘å¬åˆ°åŒæŒ‡æ‹–åŠ¨æ‰‹åŠ¿ï¼Œä¸çŸ¥è®¾è®¡æˆè¿™æ ·çš„è¡Œä¸ºä¸ä¸€è‡´æ˜¯å¦æ˜¯ Google æœ‰æ„è€Œä¸ºä¹‹ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="ä¸¾ä¾‹è¯´æ˜-2">ä¸¾ä¾‹è¯´æ˜<a class="hash-link" href="#ä¸¾ä¾‹è¯´æ˜-2" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºè¿™ä¸ªç»¿è‰²æ–¹å—æ·»åŠ å˜åŒ–æ‰‹åŠ¿å¤„ç†é€»è¾‘ã€‚<code>detectTransformGestures</code> æ–¹æ³•æä¾›äº†ä¸¤ä¸ªå‚æ•°ã€‚</p><p>panZoomLock(å¯é€‰)ï¼š å½“æ‹–åŠ¨æˆ–ç¼©æ”¾æ‰‹åŠ¿å‘ç”Ÿæ—¶æ˜¯å¦æ”¯æŒæ—‹è½¬</p><p>onGesture(å¿…é¡»)ï¼šå½“æ‹–åŠ¨ã€ç¼©æ”¾æˆ–æ—‹è½¬æ‰‹åŠ¿å‘ç”Ÿæ—¶å›è°ƒ</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun PointerInputScope.detectTransformGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    panZoomLock: Boolean = false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onGesture: (centroid: Offset, pan: Offset, zoom: Float, rotation: Float) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>ğŸ’¡ <strong>Tips</strong></p><p>å…³äºåç§»ã€ç¼©æ”¾ä¸æ—‹è½¬ï¼Œæˆ‘ä»¬å»ºè®®çš„è°ƒç”¨é¡ºåºæ˜¯ rotate -&gt; scale -&gt; offset</p><ol><li><p>è‹¥offsetå‘ç”Ÿåœ¨rotateä¹‹å‰æ—¶ï¼Œrotateä¼šå¯¹offseté€ æˆå½±å“ã€‚å…·ä½“è¡¨ç°ä¸ºå½“å‡ºç°æ‹–åŠ¨æ‰‹åŠ¿æ—¶ï¼Œç»„ä»¶ä¼šä»¥å½“å‰è§’åº¦ä¸ºåæ ‡è½´è¿›è¡Œåç§»ã€‚</p></li><li><p>è‹¥offsetå‘ç”Ÿåœ¨scaleä¹‹å‰æ—¶ï¼Œscaleä¹Ÿä¼šå¯¹offseté€ æˆå½±å“ã€‚å…·ä½“è¡¨ç°ä¸ºUIç»„ä»¶åœ¨æ‹–åŠ¨æ—¶ä¸è·Ÿæ‰‹</p></li></ol></blockquote><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun TransformGestureDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var boxSize = 100.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var offset by remember { mutableStateOf(Offset.Zero) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var ratationAngle by remember { mutableStateOf(0f) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var scale by remember { mutableStateOf(1f) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(Modifier.fillMaxSize(), contentAlignment = Alignment.Center) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(boxSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .rotate(ratationAngle) // éœ€è¦æ³¨æ„offsetä¸rotateçš„è°ƒç”¨å…ˆåé¡ºåº</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .scale(scale)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .offset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                IntOffset(offset.x.roundToInt(), offset.y.roundToInt())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                detectTransformGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    panZoomLock = true, // å¹³ç§»æˆ–æ”¾å¤§æ—¶æ˜¯å¦å¯ä»¥æ—‹è½¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onGesture = { centroid: Offset, pan: Offset, zoom: Float, rotation: Float -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        offset += pan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        scale *= zoom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ratationAngle += rotation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div align="center"><img src="/assets/images/transform-9b4172346bc8c9ecb20cb96966e06fc0.gif" width="50%" height="50%"></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="foreachgesture">forEachGesture<a class="hash-link" href="#foreachgesture" title="Direct link to heading">â€‹</a></h3><p>åœ¨ä¼ ç»Ÿ View ç³»ç»Ÿä¸­ï¼Œä¸€æ¬¡æ‰‹æŒ‡æŒ‰ä¸‹ã€ç§»åŠ¨åˆ°æŠ¬èµ·è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ‰‹åŠ¿äº‹ä»¶å¯ä»¥å…±åŒæ„æˆä¸€ä¸ªæ‰‹åŠ¿äº‹ä»¶åºåˆ—ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æ¥å¯¹äºæ¯ä¸€ä¸ªæ‰‹åŠ¿äº‹ä»¶åºåˆ—è¿›è¡Œå®šåˆ¶å¤„ç†ã€‚Compose æä¾›äº† <code>forEachGesture</code> ä»¥å…è®¸ç”¨æˆ·å¯ä»¥å¯¹æ¯ä¸€ä¸ªæ‰‹åŠ¿äº‹ä»¶åºåˆ—è¿›è¡Œç›¸åŒçš„å®šåˆ¶å¤„ç†ã€‚å¦‚æœæˆ‘ä»¬å¿˜è®°ä½¿ç”¨ <code>forEachGesture</code> ï¼Œé‚£ä¹ˆåªä¼šå¤„ç†ç¬¬ä¸€æ¬¡æ‰‹åŠ¿äº‹ä»¶åºåˆ—ã€‚æœ‰äº›åŒå­¦å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½åœ¨æ‰‹åŠ¿å¤„ç†é€»è¾‘æœ€å¤–å±‚å¥—ä¸€å±‚ <code>while(true) </code> å‘¢ï¼Œé€šè¿‡ <code>forEachGesture</code> çš„å®ç°æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>forEachGesture</code> å…¶å®å†…éƒ¨ä¹Ÿæ˜¯ç”±<code>while </code> å®ç°çš„ï¼Œé™¤æ­¤ä¹‹å¤–ä»–ä¿è¯äº†åç¨‹åªæœ‰å­˜æ´»æ—¶æ‰èƒ½ç›‘å¬æ‰‹åŠ¿äº‹ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¿è¯äº†æ¯æ¬¡äº¤äº’ç»“æŸæ—¶æ‰€æœ‰æ‰‹æŒ‡éƒ½æ˜¯ç¦»å¼€å±å¹•çš„ã€‚æœ‰äº›åŒå­¦çœ‹åˆ° <code>while</code> å¯èƒ½æ–°ç”Ÿç–‘é—®ï¼Œéš¾é“è¿™æ ·ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹å˜›ï¼Ÿå…¶å®æˆ‘ä»¬åœ¨ä»‹ç» <code>PointerInput Modifier</code> æ—¶å°±æåˆ°è¿‡ï¼Œæˆ‘ä»¬çš„æ‰‹åŠ¿æ“ä½œå¤„ç†å‡å‘ç”Ÿåœ¨åç¨‹ä¸­ã€‚å…¶å®å‰é¢æˆ‘ä»¬æ‰€æåˆ°çš„ç»å¤§å¤šæ•° API å…¶å†…éƒ¨å®ç°å‡ä½¿ç”¨äº† <code>forEachGesture</code> ã€‚æœ‰äº›ç‰¹æ®Šåœºæ™¯ä¸‹æˆ‘ä»¬ä»…ä½¿ç”¨å‰é¢æ‰€æå‡ºçš„ API å¯èƒ½ä»ç„¶æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œå½“ç„¶å¦‚æœå¯ä»¥æ»¡è¶³çš„è¯æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å…¶åˆ†åˆ«å¯¹åº”çš„ <code>Modifier</code> å³å¯ï¼Œå‰é¢æ‰€æå‡ºçš„ API å­˜åœ¨çš„æ„ä¹‰æ˜¯ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…ä¸ºå…¶è¿›è¡ŒåŠŸèƒ½æ‹“å±•ã€‚æ—¢ç„¶è¦æŒæ¡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†ï¼Œæˆ‘ä»¬å°±è¦ä»æ›´åº•å±‚è§’åº¦æ¥çœ‹è¿™äº›ä¸Šå±‚ API æ˜¯å¦‚ä½•å®ç°çš„ï¼Œäº†è§£åŸç†æˆ‘ä»¬å°±å¯ä»¥è½»æ¾è‡ªå®šä¹‰äº†ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun PointerInputScope.forEachGesture(block: suspend PointerInputScope.() -&gt; Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val currentContext = currentCoroutineContext()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (currentContext.isActive) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            block()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æŒ‚èµ·ç­‰å¾…æ‰€æœ‰æ‰‹æŒ‡æŠ¬èµ·</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            awaitAllPointersUp()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (e: CancellationException) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ‰‹åŠ¿äº‹ä»¶ä½œç”¨åŸŸ-awaitpointereventscope">æ‰‹åŠ¿äº‹ä»¶ä½œç”¨åŸŸ awaitPointerEventScope<a class="hash-link" href="#æ‰‹åŠ¿äº‹ä»¶ä½œç”¨åŸŸ-awaitpointereventscope" title="Direct link to heading">â€‹</a></h2><p>åœ¨ <code>PointerInputScope</code> ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªåä¸º <code>awaitPointerEventScope</code> çš„ API æ–¹æ³•ã€‚</p><p>é€šè¿‡ç¿»é˜…æ–¹æ³•å£°æ˜å¯ä»¥å‘ç°è¿™æ˜¯ä¸ªæŒ‚èµ·æ–¹æ³•ï¼Œå…¶å°¾éƒ¨ lambda åœ¨ <code>AwaitPointerEventScope</code> ä½œç”¨åŸŸä¸­ã€‚ é€šè¿‡è¿™ä¸ª <code>AwaitPointerEventScope</code> ä½œç”¨åŸŸæˆ‘ä»¬å¯ä»¥è·å–åˆ°æ›´åŠ åº•å±‚çš„ API æ‰‹åŠ¿äº‹ä»¶ï¼Œè¿™ä¹Ÿä¸ºè‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æä¾›äº†å¯èƒ½ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun &lt;R&gt; awaitPointerEventScope(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    block: suspend AwaitPointerEventScope.() -&gt; R</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): R</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æˆ‘ä»¬åœ¨ <code>AwaitPointerEventScope</code> ä¸­å‘ç°äº†ä»¥ä¸‹è¿™äº›åŸºç¡€æ‰‹åŠ¿æ–¹æ³•ï¼Œå¯ä»¥å‘ç°è¿™äº› API å‡æ˜¯æŒ‚èµ·å‡½æ•°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šå¯¹æ¯ä¸ª API è¿›è¡Œæè¿°è¯´æ˜ã€‚</p><table><thead><tr><th>APIåç§°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>awaitPointerEvent</td><td>æ‰‹åŠ¿äº‹ä»¶</td></tr><tr><td>awaitFirstDown</td><td>ç¬¬ä¸€æ ¹æ‰‹æŒ‡çš„æŒ‰ä¸‹äº‹ä»¶</td></tr><tr><td>drag</td><td>æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>horizontalDrag</td><td>æ°´å¹³æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>verticalDrag</td><td>å‚ç›´æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitDragOrCancellation</td><td>å•æ¬¡æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitHorizontalDragOrCancellation</td><td>å•æ¬¡æ°´å¹³æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitVerticalDragOrCancellation</td><td>å•æ¬¡å‚ç›´æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitTouchSlopOrCancellation</td><td>æœ‰æ•ˆæ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitHorizontalTouchSlopOrCancellation</td><td>æœ‰æ•ˆæ°´å¹³æ‹–åŠ¨äº‹ä»¶</td></tr><tr><td>awaitVerticalTouchSlopOrCancellation</td><td>æœ‰æ•ˆå‚ç›´æ‹–åŠ¨äº‹ä»¶</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="ä¸‡ç‰©ä¹‹æº-awaitpointerevent">ä¸‡ç‰©ä¹‹æº awaitPointerEvent<a class="hash-link" href="#ä¸‡ç‰©ä¹‹æº-awaitpointerevent" title="Direct link to heading">â€‹</a></h3><p><code>awaitPointerEvent</code> ç±»ä¼¼äºä¼ ç»Ÿ View ç³»ç»Ÿçš„ <code>onTouchEvent()</code> ã€‚æ— è®ºç”¨æˆ·æ˜¯æŒ‰ä¸‹ã€ç§»åŠ¨æˆ–æŠ¬èµ·éƒ½å°†è§†ä½œä¸€æ¬¡æ‰‹åŠ¿äº‹ä»¶ï¼Œå½“æ‰‹åŠ¿äº‹ä»¶å‘ç”Ÿæ—¶ <code>awaitPointerEvent</code> ä¼šæ¢å¤æ‰§è¡Œå¹¶å°†æ‰‹åŠ¿äº‹ä»¶è¿”å›ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun awaitPointerEvent(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pass: PointerEventPass = PointerEventPass.Main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): PointerEvent</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>é€šè¿‡ API å£°æ˜å¯ä»¥çœ‹åˆ° <code>awaitPointerEvent</code> æœ‰ä¸ªå¯é€‰å‚æ•° <code>PointerEventPass</code></p><p>æˆ‘ä»¬çŸ¥é“æ‰‹åŠ¿äº‹ä»¶çš„åˆ†å‘æ˜¯ç”±çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶çš„å•é“¾ç»“æ„ã€‚è¿™ä¸ªå‚æ•°ç›®çš„æ˜¯ç”¨ä»¥è®¾ç½®çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶çš„äº‹ä»¶åˆ†å‘é¡ºåºï¼Œ<code>PointerEventPass</code> æœ‰ 3 ä¸ªæšä¸¾å€¼å¯ä¾›é€‰æ‹©ï¼Œæ¯ä¸ªæšä¸¾å€¼çš„å…·ä½“å«ä¹‰å¦‚ä¸‹</p><table><thead><tr><th>æšä¸¾å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>PointerEventPass.Initial</td><td>æœ¬ç»„ä»¶ä¼˜å…ˆå¤„ç†æ‰‹åŠ¿ï¼Œå¤„ç†åäº¤ç»™å­ç»„ä»¶</td></tr><tr><td>PointerEventPass.Main</td><td>è‹¥å­ç»„ä»¶ä¸ºFinalï¼Œæœ¬ç»„ä»¶ä¼˜å…ˆå¤„ç†æ‰‹åŠ¿ã€‚å¦åˆ™å°†æ‰‹åŠ¿äº¤ç»™å­ç»„ä»¶å¤„ç†ï¼Œç»“æŸåæœ¬ç»„ä»¶å†å¤„ç†ã€‚</td></tr><tr><td>PointerEventPass.Final</td><td>è‹¥å­ç»„ä»¶ä¹Ÿä¸ºFinalï¼Œæœ¬ç»„ä»¶ä¼˜å…ˆå¤„ç†æ‰‹åŠ¿ã€‚å¦åˆ™å°†æ‰‹åŠ¿äº¤ç»™å­ç»„ä»¶å¤„ç†ï¼Œç»“æŸåæœ¬ç»„ä»¶å†å¤„ç†ã€‚</td></tr></tbody></table><p>å¤§å®¶å¯èƒ½è§‰å¾— Main ä¸ Final æ˜¯ç­‰ä»·çš„ã€‚ä½†å…¶å®ä¸¤è€…åœ¨ä½œä¸ºå­ç»„ä»¶æ—¶åˆ†å‘é¡ºåºä¼šå®Œå…¨ä¸åŒï¼Œä¸¾ä¸ªä¾‹å­ã€‚</p><p>å½“çˆ¶ç»„ä»¶ä¸ºFinalï¼Œå­ç»„ä»¶ä¸ºMainæ—¶ï¼Œäº‹ä»¶åˆ†å‘é¡ºåºï¼š å­ç»„ä»¶  -&gt; çˆ¶ç»„ä»¶</p><p>å½“çˆ¶ç»„ä»¶ä¸ºFinalï¼Œå­ç»„ä»¶ä¸ºFinalæ—¶ï¼Œäº‹ä»¶åˆ†å‘é¡ºåºï¼š çˆ¶ç»„ä»¶ -&gt; å­ç»„ä»¶</p><p>æ–‡å­—æè¿°å¯èƒ½å¹¶ä¸ç›´è§‚ï¼Œæ¥ä¸‹æ¥è¿›è¡Œä¸¾ä¾‹è¯´æ˜ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="äº‹ä»¶åˆ†å‘æµç¨‹">äº‹ä»¶åˆ†å‘æµç¨‹<a class="hash-link" href="#äº‹ä»¶åˆ†å‘æµç¨‹" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªåµŒå¥—äº†ä¸‰å±‚ Box çš„ç¤ºä¾‹æ¥ç›´è§‚è¡¨ç°äº‹ä»¶åˆ†å‘è¿‡ç¨‹ã€‚æˆ‘ä»¬ä¸ºè¿™åµŒå¥—çš„ä¸‰å±‚Box ä¸­çš„æ¯ä¸€å±‚éƒ½è¿›è¡Œæ‰‹åŠ¿è·å–ã€‚</p><img src="/assets/images/box_nest-ae9dd4c99af7a066741ffdf0aceb94fe.jpg" width="50%" height="50%"><p>å¦‚æœæˆ‘ä»¬ç‚¹å‡»ä¸­é—´çš„ç»¿è‰²æ–¹å—æ—¶ï¼Œä¾¿ä¼šè§¦å‘æ‰‹åŠ¿äº‹ä»¶ã€‚</p><p>å½“ä¸‰å±‚ Box å‡ä½¿ç”¨é»˜è®¤ Main æ¨¡å¼æ—¶ï¼Œäº‹ä»¶åˆ†å‘é¡ºåºä¸ºï¼šç¬¬ä¸‰å±‚ -&gt; ç¬¬äºŒå±‚ -&gt; ç¬¬ä¸€å±‚</p><p>å½“ç¬¬ä¸€å±‚Boxä½¿ç”¨ Inital æ¨¡å¼ï¼Œç¬¬äºŒå±‚ä½¿ç”¨ Final æ¨¡å¼ï¼Œç¬¬ä¸‰å±‚ä½¿ç”¨ Main æ¨¡å¼æ—¶ï¼Œäº‹ä»¶åˆ†å‘é¡ºåºä¸ºï¼šç¬¬ä¸€å±‚ -&gt; ç¬¬ä¸‰å±‚ -&gt; ç¬¬äºŒå±‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun NestedBoxDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEvent(PointerEventPass.Initial)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Log.d(&quot;compose_study&quot;, &quot;first layer&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .size(400.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .background(Color.Blue)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        awaitPointerEvent(PointerEventPass.Final)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Log.d(&quot;compose_study&quot;, &quot;second layer&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .size(200.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            Log.d(&quot;compose_study&quot;, &quot;third layer&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// first layer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// third layer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// second layer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>èƒ½å¤Ÿè‡ªå®šä¹‰äº‹ä»¶åˆ†å‘é¡ºåºä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†³å®šæ‰‹åŠ¿äº‹ä»¶ç”±äº‹ä»¶åˆ†å‘æµç¨‹ä¸­å“ªä¸ªç»„ä»¶è¿›è¡Œæ¶ˆè´¹ã€‚é‚£ä¹ˆå¦‚ä½•è¿›è¡Œæ¶ˆè´¹å‘¢ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬çœ‹çœ‹ <code>awaitPointerEvent</code> è¿”å›çš„æ‰‹åŠ¿äº‹ä»¶äº†ã€‚é€šè¿‡ <code>awaintPointerEvent</code> å£°æ˜ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿”å›çš„æ‰‹åŠ¿äº‹ä»¶æ˜¯ä¸ª <code>PointerEvent</code> å®ä¾‹ã€‚</p><p>é€šè¿‡ <code>PointerEvent</code> ç±»å£°æ˜ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæˆå‘˜å±æ€§ changes ä¸ motionEventã€‚</p><p>motionEvent æˆ‘ä»¬å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œå°±æ˜¯ä¼ ç»Ÿ View ç³»ç»Ÿä¸­çš„æ‰‹åŠ¿äº‹ä»¶ï¼Œç„¶è€Œå´è¢«å£°æ˜äº† internal å…³é”®å­—ï¼Œçœ‹æ¥æ˜¯ä¸å¸Œæœ›æˆ‘ä»¬ä½¿ç”¨ã€‚</p><p>changes æ˜¯ä¸€ä¸ª Listï¼Œå…¶ä¸­åŒ…å«äº†æ¯æ¬¡å‘ç”Ÿæ‰‹åŠ¿äº‹ä»¶æ—¶ï¼Œå±å¹•ä¸Šæ‰€æœ‰æ‰‹æŒ‡çš„çŠ¶æ€ä¿¡æ¯ã€‚</p><p>å½“åªæœ‰ä¸€æ ¹æ‰‹æŒ‡æ—¶ï¼Œè¿™ä¸ª List çš„å¤§å°ä¸º 1ã€‚åœ¨å¤šæŒ‡æ“ä½œæ—¶ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ª List è·å–å…¶ä»–æ‰‹æŒ‡çš„çŠ¶æ€ä¿¡æ¯å°±å¯ä»¥è½»æ¾å®šåˆ¶å¤šæŒ‡è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†äº†ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">actual data class PointerEvent internal constructor(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    actual val changes: List&lt;PointerInputChange&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    internal val motionEvent: MotionEvent?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="pointerinputchange">PointerInputChange<a class="hash-link" href="#pointerinputchange" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">class PointerInputChange(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val id: PointerId, // æ‰‹æŒ‡Id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val uptimeMillis: Long, // å½“å‰æ‰‹åŠ¿äº‹ä»¶çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val position: Offset, // å½“å‰æ‰‹åŠ¿äº‹ä»¶ç›¸å¯¹ç»„ä»¶å·¦ä¸Šè§’çš„ä½ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val pressed: Boolean, // å½“å‰æ‰‹åŠ¿æ˜¯å¦æŒ‰ä¸‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val previousUptimeMillis: Long, // ä¸Šä¸€æ¬¡æ‰‹åŠ¿äº‹ä»¶çš„æ—¶é—´æˆ³</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val previousPosition: Offset, // ä¸Šä¸€æ¬¡æ‰‹åŠ¿äº‹ä»¶ç›¸å¯¹ç»„ä»¶å·¦ä¸Šè§’çš„ä½ç½®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val previousPressed: Boolean, // ä¸Šä¸€æ¬¡æ‰‹åŠ¿æ˜¯å¦æŒ‰ä¸‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val consumed: ConsumedData, // å½“å‰æ‰‹åŠ¿æ˜¯å¦å·²è¢«æ¶ˆè´¹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val type: PointerType = PointerType.Touch // æ‰‹åŠ¿ç±»å‹(é¼ æ ‡ã€æ‰‹æŒ‡ã€æ‰‹å†™ç¬”ã€æ©¡çš®) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><table><thead><tr><th>APIåç§°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>changedToDown</td><td>æ˜¯å¦å·²ç»æŒ‰ä¸‹(æŒ‰ä¸‹æ‰‹åŠ¿å·²æ¶ˆè´¹åˆ™è¿”å›false)</td></tr><tr><td>changedToDownIgnoreConsumed</td><td>æ˜¯å¦å·²ç»æŒ‰ä¸‹(å¿½ç•¥æŒ‰ä¸‹æ‰‹åŠ¿å·²æ¶ˆè´¹æ ‡è®°)</td></tr><tr><td>changedToUp</td><td>æ˜¯å¦å·²ç»æŠ¬èµ·(æŒ‰ä¸‹æ‰‹åŠ¿å·²æ¶ˆè´¹åˆ™è¿”å›false)</td></tr><tr><td>changedToUpIgnoreConsumed</td><td>æ˜¯å¦å·²ç»æŠ¬èµ·(å¿½ç•¥æŒ‰ä¸‹æ‰‹åŠ¿å·²æ¶ˆè´¹æ ‡è®°)</td></tr><tr><td>positionChanged</td><td>æ˜¯å¦ä½ç½®å‘ç”Ÿäº†æ”¹å˜(ç§»åŠ¨æ‰‹åŠ¿å·²æ¶ˆè´¹åˆ™è¿”å›false)</td></tr><tr><td>positionChangedIgnoreConsumed</td><td>æ˜¯å¦ä½ç½®å‘ç”Ÿäº†æ”¹å˜(å¿½ç•¥å·²æ¶ˆè´¹æ ‡è®°)</td></tr><tr><td>positionChange</td><td>ä½ç½®æ”¹å˜é‡(ç§»åŠ¨æ‰‹åŠ¿å·²æ¶ˆè´¹åˆ™è¿”å›Offset.Zero)</td></tr><tr><td>positionChangeIgnoreConsumed</td><td>ä½ç½®æ”¹å˜é‡(å¿½ç•¥ç§»åŠ¨æ‰‹åŠ¿å·²æ¶ˆè´¹æ ‡è®°)</td></tr><tr><td>positionChangeConsumed</td><td>å½“å‰ç§»åŠ¨æ‰‹åŠ¿æ˜¯å¦å·²è¢«æ¶ˆè´¹</td></tr><tr><td>anyChangeConsumed</td><td>å½“å‰æŒ‰ä¸‹æ‰‹åŠ¿æˆ–ç§»åŠ¨æ‰‹åŠ¿æ˜¯å¦æœ‰è¢«æ¶ˆè´¹</td></tr><tr><td>consumeDownChange</td><td>æ¶ˆè´¹æŒ‰ä¸‹æ‰‹åŠ¿</td></tr><tr><td>consumePositionChange</td><td>æ¶ˆè´¹ç§»åŠ¨æ‰‹åŠ¿</td></tr><tr><td>consumeAllChanges</td><td>æ¶ˆè´¹æŒ‰ä¸‹ä¸ç§»åŠ¨æ‰‹åŠ¿</td></tr><tr><td>isOutOfBounds</td><td>å½“å‰æ‰‹åŠ¿æ˜¯å¦åœ¨å›ºå®šèŒƒå›´å†…</td></tr></tbody></table><p>è¿™äº› API ä¼šåœ¨æˆ‘ä»¬è‡ªå®šä¹‰æ‰‹åŠ¿å¤„ç†æ—¶ä¼šè¢«ç”¨åˆ°ã€‚å¯ä»¥å‘ç°çš„æ˜¯ï¼ŒCompose é€šè¿‡ <code>PointerEventPass</code> æ¥å®šåˆ¶äº‹ä»¶åˆ†å‘æµç¨‹ï¼Œåœ¨äº‹ä»¶åˆ†å‘æµç¨‹ä¸­å³ä½¿å‰ä¸€ä¸ªç»„ä»¶å…ˆè·å–äº†æ‰‹åŠ¿ä¿¡æ¯å¹¶è¿›è¡Œäº†æ¶ˆè´¹ï¼Œåé¢çš„ç»„ä»¶ä»ç„¶å¯ä»¥é€šè¿‡å¸¦æœ‰ <code>IgnoreConsumed</code> ç³»åˆ— API æ¥è·å–åˆ°æ‰‹åŠ¿ä¿¡æ¯ã€‚è¿™ä¹Ÿæå¤§å¢åŠ äº†æ‰‹åŠ¿æ“ä½œçš„å¯å®šåˆ¶æ€§ã€‚å°±å¥½åƒçˆ¶ç»„ä»¶å…ˆæŠŠäº‹ä»¶æ¶ˆè´¹ï¼Œå¸Œæœ›å­ç»„ä»¶ä¸è¦å¤„ç†è¿™ä¸ªæ‰‹åŠ¿äº†ï¼Œä½†å­ç»„ä»¶å®Œå…¨å¯ä»¥ä¸ç”¨å¬ä»çˆ¶ç»„ä»¶çš„è¯ã€‚</p><p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹çœ‹è¯¥å¦‚ä½•è¿›è¡Œæ‰‹åŠ¿æ¶ˆè´¹ï¼Œå¤„äºæ–¹ä¾¿æˆ‘ä»¬çš„ç¤ºä¾‹ä¸æ¶‰åŠç§»åŠ¨ï¼Œåªæ¶ˆè´¹æŒ‰ä¸‹æ‰‹åŠ¿äº‹ä»¶æ¥è¿›è¡Œä¸¾ä¾‹ã€‚å’Œä¹‹å‰çš„æ ·å¼ä¸€æ ·ï¼Œæˆ‘ä»¬å°†æ‰‹åŠ¿æ¶ˆè´¹æ”¾åœ¨äº†ç¬¬ä¸‰å±‚ Boxï¼Œæ ¹æ®äº‹ä»¶åˆ†å‘è§„åˆ™æˆ‘ä»¬çŸ¥é“ç¬¬ä¸‰å±‚Boxæ˜¯ç¬¬2ä¸ªå¤„ç†æ‰‹åŠ¿äº‹ä»¶çš„ï¼Œæ‰€ä»¥è¾“å‡ºç»“æœå¦‚ä¸‹ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun Demo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    var event = awaitPointerEvent(PointerEventPass.Initial)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Log.d(&quot;compose_study&quot;, &quot;first layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .size(400.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .background(Color.Blue)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        var event = awaitPointerEvent(PointerEventPass.Final)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Log.d(&quot;compose_study&quot;, &quot;second layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .size(200.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            var event = awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            event.changes[0].consumeDownChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            Log.d(&quot;compose_study&quot;, &quot;third layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// first layer, downChange: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// third layer, downChange: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// second layer, downChange: true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>âš ï¸ <strong>æ³¨æ„äº‹é¡¹</strong></p><p>å¦‚æœæˆ‘ä»¬æ˜¯åœ¨å®šåˆ¶äº‹ä»¶åˆ†å‘æµç¨‹ï¼Œé‚£ä¹ˆéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç§å†™æ³•</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">// æ­£ç¡®å†™æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var event = awaitPointerEvent() </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event.changes[0].consumeDownChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// é”™è¯¯å†™æ³•</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var event = awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">event.changes[0].consumeDownChange()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>ä»–ä»¬çš„åŒºåˆ«åœ¨äº <code>awaitPointerEventScope</code> ä¼šåœ¨å…¶å†…éƒ¨æ‰€æœ‰æ‰‹åŠ¿åœ¨äº‹ä»¶åˆ†å‘æµç¨‹ç»“æŸåè¿”å›ï¼Œå½“æ‰€æœ‰ç»„ä»¶éƒ½å·²ç»å®Œæˆæ‰‹åŠ¿å¤„ç†å†è¿›è¡Œæ¶ˆè´¹å·²ç»æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚æˆ‘ä»¬ä»ç„¶ç”¨åˆšæ‰çš„ä¾‹å­æ¥ç›´è§‚è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬åœ¨æ¯ä¸€å±‚Box <code>awaitPointerEventScope</code> åé¢æ·»åŠ äº†æ—¥å¿—ä¿¡æ¯ã€‚</p><p>é€šè¿‡è¾“å‡ºç»“æœå¯ä»¥å‘ç°ï¼Œè¿™ä¸‰å±‚æ‰§è¡Œçš„ç›¸å¯¹é¡ºåºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œç„¶è€Œå´æ˜¯åœ¨äº‹ä»¶åˆ†å‘æµç¨‹ç»“æŸåæ‰è¿›è¡Œè¾“å‡ºçš„ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun Demo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    var event = awaitPointerEvent(PointerEventPass.Initial)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Log.d(&quot;compose_study&quot;, &quot;first layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Log.d(&quot;compose_study&quot;, &quot;first layer Outside&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            modifier = Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .size(400.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .background(Color.Blue)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        var event = awaitPointerEvent(PointerEventPass.Final)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Log.d(&quot;compose_study&quot;, &quot;second layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Log.d(&quot;compose_study&quot;, &quot;second layer Outside&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Box(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .size(200.dp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            var event = awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            event.changes[0].consumeDownChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            Log.d(&quot;compose_study&quot;, &quot;third layer, downChange: ${event.changes[0].consumed.downChange}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Log.d(&quot;compose_study&quot;, &quot;third layer Outside&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Output:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// first layer, downChange: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// third layer, downChange: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// second layer, downChange: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// first layer Outside</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// third layer Outside</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// second layer Outside</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="awaitfirstdown">awaitFirstDown<a class="hash-link" href="#awaitfirstdown" title="Direct link to heading">â€‹</a></h3><p><code>awaitFirstDown</code> å°†ç­‰å¾…ç¬¬ä¸€æ ¹æ‰‹æŒ‡æŒ‰ä¸‹äº‹ä»¶æ—¶æ¢å¤æ‰§è¡Œï¼Œå¹¶å°†æ‰‹æŒ‡æŒ‰ä¸‹äº‹ä»¶è¿”å›ã€‚åˆ†ææºç æˆ‘ä»¬å¯ä»¥å‘ç° <code>awaitFirstDown</code> ä¹Ÿä½¿ç”¨çš„æ˜¯ <code>awaitPointerEvent</code> å®ç°çš„ï¼Œé»˜è®¤ä½¿ç”¨ Main æ¨¡å¼ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun AwaitPointerEventScope.awaitFirstDown(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requireUnconsumed: Boolean = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): PointerInputChange {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var event: PointerEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    do {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        event = awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } while (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        !event.changes.fastAll {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (requireUnconsumed) it.changedToDown() else it.changedToDownIgnoreConsumed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return event.changes[0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="drag">drag<a class="hash-link" href="#drag" title="Direct link to heading">â€‹</a></h3><p>çœ‹åˆ° <code>drag</code> å¯èƒ½å¾ˆå¤šåŒå­¦ç–‘æƒ‘ä¸ºä»€ä¹ˆåˆæ˜¯æ‹–åŠ¨ã€‚å…¶å®å‰é¢æ‰€æåˆ°çš„æ‹–åŠ¨ç±»å‹åŸºç¡€API <code>detectDragGestures</code> å…¶å†…éƒ¨å°±æ˜¯ä½¿ç”¨ <code>drag</code> è€Œå®ç°çš„ã€‚ä¸ <code>detectDragGestures</code> ä¸åŒçš„æ˜¯ï¼Œ<code>drag</code> éœ€è¦ä¸»åŠ¨ä¼ å…¥ä¸€ä¸ª <code>PointerId</code> ç”¨ä»¥è¡¨ç¤ºè¦å…·ä½“è·å–åˆ°å“ªæ ¹æ‰‹æŒ‡çš„æ‹–åŠ¨äº‹ä»¶ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun AwaitPointerEventScope.drag(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pointerId: PointerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDrag: (PointerInputChange) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>ç¿»é˜…æºç å¯ä»¥å‘ç°ï¼Œå…¶å® drag å†…éƒ¨å®ç°æœ€ç»ˆä½¿ç”¨çš„ä»ç„¶è¿˜æ˜¯ <code>awaitPointerEvent</code> ã€‚è¿™é‡Œå°±ä¸å…·ä½“å±•å¼€çœ‹äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»è·Ÿæºç ã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="ä¸¾ä¾‹è¯´æ˜-3">ä¸¾ä¾‹è¯´æ˜<a class="hash-link" href="#ä¸¾ä¾‹è¯´æ˜-3" title="Direct link to heading">â€‹</a></h4><p>é€šè¿‡ç»“åˆ <code>awaitFirstDown</code> ä¸ <code>drag</code> è¿™äº›åŸºç¡€ API æˆ‘ä»¬å·²ç»å¯ä»¥è‡ªå·±å®ç° UI æ‹–åŠ¨æ‰‹åŠ¿æµç¨‹äº†ã€‚æˆ‘ä»¬ä»ç„¶ä»¥æˆ‘ä»¬çš„ç»¿è‰²æ–¹å—ä½œä¸ºå®ä¾‹ï¼Œä¸ºå…¶æ·»åŠ æ‹–åŠ¨æ‰‹åŠ¿ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun BaseDragGestureDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var boxSize = 100.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var offset by remember { mutableStateOf(Offset.Zero) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier.fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(boxSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .offset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                IntOffset(offset.x.roundToInt(), offset.y.roundToInt())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                forEachGesture { // å¾ªç¯ç›‘å¬æ¯ä¸€ç»„äº‹ä»¶åºåˆ—</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        var downEvent = awaitFirstDown()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        drag(downEvent.id) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            offset += it.positionChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div align="center"><img src="/assets/images/drag-80a95888973e3f8aff22b90304b4086d.gif" width="50%" height="50%"></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="awaitdragorcancellation">awaitDragOrCancellation<a class="hash-link" href="#awaitdragorcancellation" title="Direct link to heading">â€‹</a></h3><p>ä¸ <code>drag</code> ä¸åŒçš„æ˜¯ï¼Œ<code>awaitDragOrCancellation</code> è´Ÿè´£ç›‘å¬å•æ¬¡æ‹–åŠ¨äº‹ä»¶ã€‚å½“æ‰‹æŒ‡å·²ç»æŠ¬èµ·æˆ–æ‹–åŠ¨äº‹ä»¶å·²ç»è¢«æ¶ˆè´¹æ—¶ä¼šè¿”å› nullã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>awaitDragOrCancellation</code> æ¥å®Œæˆ UI æ‹–åŠ¨æ‰‹åŠ¿å¤„ç†æµç¨‹ã€‚é€šè¿‡ç¿»é˜…æºç å¯ä»¥å‘ç° <code>drag</code> å…¶å®å†…éƒ¨ä¹Ÿæ˜¯ä½¿ç”¨ <code>awaitDragOrCancellation</code> è¿›è¡Œå®ç°çš„ã€‚è€Œ <code>awaitDragOrCancellation</code> å†…éƒ¨ä»ç„¶æ˜¯ <code>awaitPointerEvent</code>ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">@Preview</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun BaseDragGestureDemo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var boxSize = 100.dp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var offset by remember { mutableStateOf(Offset.Zero) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Box(contentAlignment = Alignment.Center,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        modifier = Modifier.fillMaxSize()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Box(Modifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .size(boxSize)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .offset {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                IntOffset(offset.x.roundToInt(), offset.y.roundToInt())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .background(Color.Green)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .pointerInput(Unit) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                forEachGesture {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        var downPointer = awaitFirstDown()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            var event = awaitDragOrCancellation(downPointer.id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            if (event == null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                break</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            offset += event.positionChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="awaittouchsloporcancellation">awaitTouchSlopOrCancellation<a class="hash-link" href="#awaittouchsloporcancellation" title="Direct link to heading">â€‹</a></h3><p><code>awaitTouchSlopOrCancellation</code> ç”¨äºç›‘æµ‹å½“å‰æ‹–åŠ¨æ‰‹åŠ¿æ˜¯å¦æ˜¯ä¸€æ¬¡æœ‰æ•ˆçš„æ‹–åŠ¨ã€‚æœ‰æ•ˆæŒ‡çš„æ˜¯å½“å‰æ‰‹åŠ¿æ»‘åŠ¨çš„æ¬§å¼è·ç¦»(ä½ç§»)æ˜¯å¦è¶…è¿‡è®¾å®šçš„é˜ˆå€¼ã€‚è‹¥æ‹–åŠ¨æ‰‹åŠ¿è¿˜æ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ä¾¿æŠ¬èµ·æˆ–æ‹–åŠ¨æ‰‹åŠ¿äº‹ä»¶å·²ç»è¢«æ¶ˆè´¹æ—¶å°†è¿”å›nullï¼Œç¿»é˜…æºç æˆ‘ä»¬åˆæ‰¾åˆ°äº†<code>awaitPointerEvent</code> ï¼Œæ‰€ä»¥è¯´ <code>awaitPointerEvent</code> æ˜¯ä¸‡ç‰©ä¹‹æºå˜›ï½ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun AwaitPointerEventScope.awaitTouchSlopOrCancellation(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pointerId: PointerId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onTouchSlopReached: (change: PointerInputChange, overSlop: Offset) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">): PointerInputChange? {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val touchSlop = viewConfiguration.touchSlop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var pointer = pointerId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val event = awaitPointerEvent()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (dragEvent.positionChangeConsumed()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else if (dragEvent.changedToUpIgnoreConsumed()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (distance &gt;= touchSlop) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>æˆ‘ä»¬å‰é¢æ‰€æåˆ°çš„ <code>detectDragGestures</code> å…¶å†…éƒ¨ä¸ä»…ä½¿ç”¨äº† <code>drag</code> è¿˜ä½¿ç”¨äº† <code>awaitTouchSlopOrCancellation</code> æ¥åˆ¤æ–­æ‰‹åŠ¿æ‹–åŠ¨æ“ä½œã€‚ä»…å½“ç›‘æµ‹ä¸ºä¸€æ¬¡æœ‰æ•ˆçš„æ‹–åŠ¨æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œ onDragStart å›è°ƒã€‚æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨ <code>drag</code> æ¥ç›‘å¬æ‹–åŠ¨æ‰‹åŠ¿ï¼Œä»…å½“ <code>drag</code> è¿”å› false (å³åœ¨æ‹–åŠ¨è¿‡ç¨‹ä¸­äº‹ä»¶åˆ†å‘æµç¨‹å‰é¢çš„ç»„ä»¶è¾¾æˆå®šåˆ¶æ¡ä»¶æ¶ˆè´¹äº†è¿™æ¬¡çš„æ‹–åŠ¨æ‰‹åŠ¿äº‹ä»¶) ä¼šæ‰§è¡Œ onDragCancel å›è°ƒï¼Œå¦åˆ™å¦‚æœæ‰€æœ‰æ‰‹æŒ‡æŠ¬èµ·æ­£å¸¸ç»“æŸåˆ™ä¼šæ‰§è¡Œ onDragEnd å›è°ƒã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">suspend fun PointerInputScope.detectDragGestures(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragStart: (Offset) -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragEnd: () -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDragCancel: () -&gt; Unit = { },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    onDrag: (change: PointerInputChange, dragAmount: Offset) -&gt; Unit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    forEachGesture {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        awaitPointerEventScope {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            do {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                drag = awaitTouchSlopOrCancellation(down.id) { change, over -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    change.consumePositionChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    overSlop = over</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } while (drag != null &amp;&amp; !drag.positionChangeConsumed())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (drag != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onDragStart.invoke(drag.position) // æ‹–åŠ¨å¼€å§‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                onDrag(drag, overSlop)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    !drag(drag.id) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        onDrag(it, it.positionChange())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        it.consumePositionChange()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDragCancel() // æ‹–åŠ¨å–æ¶ˆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    onDragEnd()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/milklabdev/jetpack-compose-book/tree/master/docs/design/gesture/customGesture.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/design/gesture/nestedScroll"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">åµŒå¥—æ»‘åŠ¨ï¼ˆnestedScrollï¼‰</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/category/åˆ—è¡¨lists"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">åˆ—è¡¨ï¼ˆListsï¼‰</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ä½¿ç”¨-pointerinput-modifier" class="table-of-contents__link toc-highlight">ä½¿ç”¨ PointerInput Modifier</a><ul><li><a href="#æ‹–åŠ¨ç±»å‹åŸºç¡€-api" class="table-of-contents__link toc-highlight">æ‹–åŠ¨ç±»å‹åŸºç¡€ API</a></li><li><a href="#ç‚¹å‡»ç±»å‹åŸºç¡€-api" class="table-of-contents__link toc-highlight">ç‚¹å‡»ç±»å‹åŸºç¡€ API</a></li><li><a href="#å˜æ¢ç±»å‹åŸºç¡€-api" class="table-of-contents__link toc-highlight">å˜æ¢ç±»å‹åŸºç¡€ API</a></li><li><a href="#foreachgesture" class="table-of-contents__link toc-highlight">forEachGesture</a></li></ul></li><li><a href="#æ‰‹åŠ¿äº‹ä»¶ä½œç”¨åŸŸ-awaitpointereventscope" class="table-of-contents__link toc-highlight">æ‰‹åŠ¿äº‹ä»¶ä½œç”¨åŸŸ awaitPointerEventScope</a><ul><li><a href="#ä¸‡ç‰©ä¹‹æº-awaitpointerevent" class="table-of-contents__link toc-highlight">ä¸‡ç‰©ä¹‹æº awaitPointerEvent</a></li><li><a href="#awaitfirstdown" class="table-of-contents__link toc-highlight">awaitFirstDown</a></li><li><a href="#drag" class="table-of-contents__link toc-highlight">drag</a></li><li><a href="#awaitdragorcancellation" class="table-of-contents__link toc-highlight">awaitDragOrCancellation</a></li><li><a href="#awaittouchsloporcancellation" class="table-of-contents__link toc-highlight">awaitTouchSlopOrCancellation</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/milklabdev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Milk Lab, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.279986bd.js"></script>
<script src="/assets/js/main.387f3f8c.js"></script>
</body>
</html>