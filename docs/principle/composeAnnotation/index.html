<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Compose æ³¨è§£åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ | ä½ å¥½ Compose</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://jetpackcompose.cn/docs/principle/composeAnnotation"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Compose æ³¨è§£åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ | ä½ å¥½ Compose"><meta data-react-helmet="true" name="description" content="å‰è¨€"><meta data-react-helmet="true" property="og:description" content="å‰è¨€"><link data-react-helmet="true" rel="icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://jetpackcompose.cn/docs/principle/composeAnnotation"><link data-react-helmet="true" rel="alternate" href="https://jetpackcompose.cn/docs/principle/composeAnnotation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://jetpackcompose.cn/docs/principle/composeAnnotation" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.cba56bc1.css">
<link rel="preload" href="/assets/js/runtime~main.b8d28577.js" as="script">
<link rel="preload" href="/assets/js/main.4a02c241.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Jetpack Compose åšç‰©é¦†</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/docs/open-source-project/compose-douban">å¼€æºé¡¹ç›®</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/compose-museum/jetpack-compose-book" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ğŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ğŸŒ</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">å†™åœ¨å¼€å¤´</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/å…¥é—¨">å…¥é—¨</a><button aria-label="Toggle the collapsible sidebar category &#x27;å…¥é—¨&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">å®‰è£…æˆ–æ›´æ–° Android Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial">åˆè¯† Jetpack Compose</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/elements/alertdialog">åŸºç¡€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/layout/box">å¸ƒå±€ç»„ä»¶</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/category/è®¾è®¡">è®¾è®¡</a><button aria-label="Toggle the collapsible sidebar category &#x27;è®¾è®¡&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/åŠ¨ç”»animation">åŠ¨ç”»ï¼ˆAnimationï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åŠ¨ç”»ï¼ˆAnimationï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/ä¸»é¢˜theming">ä¸»é¢˜ï¼ˆThemingï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;ä¸»é¢˜ï¼ˆThemingï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/æ‰‹åŠ¿gesture">æ‰‹åŠ¿ï¼ˆGestureï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;æ‰‹åŠ¿ï¼ˆGestureï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/åˆ—è¡¨lists">åˆ—è¡¨ï¼ˆListsï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;åˆ—è¡¨ï¼ˆListsï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/category/å›¾å½¢graphics">å›¾å½¢ï¼ˆGraphicsï¼‰</a><button aria-label="Toggle the collapsible sidebar category &#x27;å›¾å½¢ï¼ˆGraphicsï¼‰&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/resources">èµ„æº</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_VCh3" aria-current="page" href="/docs/category/æŠ€æœ¯åŸç†">æŠ€æœ¯åŸç†</a><button aria-label="Toggle the collapsible sidebar category &#x27;æŠ€æœ¯åŸç†&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/recompositionScope">äº†è§£ Compose çš„é‡ç»„ä½œç”¨åŸŸ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/snapshot">é€è¿‡ Snapshot çœ‹é‡ç»„</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/recomposeWorkingPrinciple">é‡ç»„çš„å·¥ä½œæµç¨‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/gapBuffer">Compose è¿è¡ŒåŸç†ä¸ GapBuffer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/modifierStructure">å›¾è§£ Modifier</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/principle/composeAnnotation">Compose æ³¨è§£åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/principle/composeRemoteImage">å¦‚ä½•ä¸ºCompose Imageæä¾›ç½‘ç»œå›¾ç‰‡åŠ è½½æ”¯æŒ</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Compose æ³¨è§£åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="å‰è¨€">å‰è¨€<a class="hash-link" href="#å‰è¨€" title="Direct link to heading">â€‹</a></h2><p>äº†è§£è¿‡<code>Compose</code>çš„åŒå­¦éƒ½çŸ¥é“ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª<code>@Compose</code>æ³¨è§£å°±å¯ä»¥å°†å‡½æ•°è½¬åŒ–æˆ<code>Compose</code>å‡½æ•°ï¼ŒåŒæ—¶<code>Compose</code>å‡½æ•°ä¹Ÿåªèƒ½åœ¨<code>Compose</code>å‡½æ•°ä¸­è¿è¡Œã€‚è¿™çœ‹èµ·æ¥ä¼¼ä¹è·Ÿåç¨‹æ¯”è¾ƒåƒï¼Œ<code>@Compose</code>æ˜¯ä¸æ˜¯ä¹Ÿåƒåç¨‹ä¸€æ ·ï¼Œå¾€å‡½æ•°ä¸­æ·»åŠ äº†ä¸€äº›å‚æ•°å‘¢ï¼Ÿ          </p><p>æˆ‘ä»¬å°±ä¸€èµ·æ¥çœ‹ä¸‹ï¼Œ<code>@Compose</code>åˆ°åº•åšäº†ä»€ä¹ˆï¼Œåˆæ˜¯æ€ä¹ˆåšåˆ°çš„ã€‚</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="å‰ç½®çŸ¥è¯†">å‰ç½®çŸ¥è¯†<a class="hash-link" href="#å‰ç½®çŸ¥è¯†" title="Direct link to heading">â€‹</a></h2><p>ä¸€çœ‹åˆ°<code>@Compose</code>æ³¨è§£ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±æƒ³åˆ°æ³¨è§£å¤„ç†å™¨ï¼Œä½†æ˜¯<code>@Compose</code>çš„è§£æå¹¶ä¸æ˜¯é€šè¿‡æ³¨è§£å¤„ç†å™¨æ¥å®ç°çš„ï¼Œå› ä¸ºæ³¨è§£å¤„ç†å™¨åªèƒ½ç”Ÿæˆä»£ç ï¼Œä¸èƒ½ä¿®æ”¹ä»£ç <br>
<!-- -->è€Œ<code>KCP</code>ï¼ˆ<code>Kotlin Compiler Plugin</code>ï¼‰ï¼šå³<code>kotlin</code>ç¼–è¯‘æ’ä»¶ï¼Œæ”¯æŒè·¨å¹³å°ï¼Œ<code>android</code>å¼€å‘å¯ä»¥å°†å®ƒç±»æ¯”ä¸º<code>kapt</code>+<code>transform</code>æœºåˆ¶ï¼Œæ—¢å¯ä»¥ç”Ÿæˆä»£ç ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ä»£ç    </p><p><code>@Compose</code>æ³¨è§£çš„è§£æå°±æ˜¯é€šè¿‡<code>KCP</code>æ¥å®ç°çš„     </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="ä»€ä¹ˆæ˜¯kcp">ä»€ä¹ˆæ˜¯<code>KCP</code><a class="hash-link" href="#ä»€ä¹ˆæ˜¯kcp" title="Direct link to heading">â€‹</a></h3><p><code>Kotlin</code>ç¼–è¯‘è¿‡ç¨‹ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†<code>Kotlin</code>æºç ç¼–è¯‘æˆå­—èŠ‚ç çš„è¿‡ç¨‹ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š<br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8e9be2a6884341cabd04beb6f6fb5752~tplv-k3u1fbpfcp-zoom-1.image"></p><p>è€Œ<code>Kotlin</code>ç¼–è¯‘æœŸæ’ä»¶åˆ™åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æä¾›<code>Hook</code>æ—¶æœºï¼Œè®©æˆ‘ä»¬å¯ä»¥è§£æç¬¦å·ï¼Œä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆç»“æœç­‰ã€‚<br>
<code>Kotlin</code>åº“ä¸­çš„ä¸å°‘è¯­æ³•ç³–éƒ½ç”¨åˆ°äº†<code>KCP</code>ï¼Œæ¯”å¦‚<code>Kotlin-android-extension</code>ï¼Œ<code>@Parcelize</code>ç­‰ï¼Œ<code>@Compose</code>æ³¨è§£åŒæ ·ä¹Ÿæ˜¯é€šè¿‡<code>KCP</code>è§£æçš„    </p><p>ç›¸æ¯”<code>KAPT</code>ï¼Œ<code>KCP</code>ä¸»è¦æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š     </p><ol><li><code>KAPT</code>æ˜¯åŸºäºæ³¨è§£å¤„ç†å™¨çš„ï¼Œå®ƒéœ€è¦å°†<code>Kotlin</code>ä»£ç è½¬åŒ–æˆ<code>Stub</code>å†è§£ææ³¨è§£ç”Ÿæˆä»£ç ï¼Œå¸¸å¸¸è½¬åŒ–æˆ<code>Stub</code>çš„æ—¶é—´æ¯”ç”Ÿæˆä»£ç è¿˜è¦é•¿ï¼Œè€Œ<code>KCP</code>åˆ™æ˜¯ç›´æ¥è§£æ<code>Kotlin</code>çš„ç¬¦å·ï¼Œå› æ­¤åœ¨ç¼–è¯‘é€Ÿåº¦ä¸Š<code>KCP</code>æ¯”<code>KAPT</code>è¦å¼ºçš„å¤š    </li><li><code>KAPT</code>åªèƒ½ç”Ÿæˆä»£ç ï¼Œä¸èƒ½ä¿®æ”¹ä»£ç ï¼Œè€Œ<code>KCP</code>ä¸ä»…å¯ä»¥ç”Ÿæˆä»£ç ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ä»£ç ï¼Œå¯ä»¥çœ‹ä½œæ˜¯<code>kapt</code>+<code>transorm</code>æœºåˆ¶     </li></ol><p>è€Œ<code>KCP</code>çš„ç¼ºç‚¹åˆ™åœ¨äºï¼Œ<code>KCP</code> çš„å¼€å‘æˆæœ¬å¤ªé«˜ï¼Œæ¶‰åŠ <code>Gradle Plugin</code>ã€<code>Kotlin Plugin</code> ç­‰çš„ä½¿ç”¨ï¼Œ<code>API</code> æ¶‰åŠä¸€äº›ç¼–è¯‘å™¨çŸ¥è¯†çš„äº†è§£ï¼Œä¸€èˆ¬å¼€å‘è€…å¾ˆéš¾æŒæ¡ã€‚<br>
<!-- -->å› æ­¤å¦‚æœåªæ˜¯éœ€è¦å¤„ç†æ³¨è§£ç”Ÿæˆä»£ç ï¼Œä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼Œé€šå¸¸ä½¿ç”¨<code>KSP</code>å°±è¶³å¤Ÿäº†ï¼Œ<code>KSP</code>æ˜¯å¯¹<code>KCP</code>çš„ä¸€ä¸ªå°è£…ï¼Œå¦‚æœå¯¹<code>KSP</code>çš„ä½¿ç”¨è¯¦æƒ…æ„Ÿå…´è¶£å¯å‚è§ï¼š<a href="https://juejin.cn/post/6979759813467062309" target="_blank" rel="noopener noreferrer">å‘Šåˆ«KAPTï¼ä½¿ç”¨ KSP ä¸º Kotlin ç¼–è¯‘æé€Ÿ</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="kcpçš„åŸºæœ¬æ¦‚å¿µ"><code>KCP</code>çš„åŸºæœ¬æ¦‚å¿µ<a class="hash-link" href="#kcpçš„åŸºæœ¬æ¦‚å¿µ" title="Direct link to heading">â€‹</a></h3><p>ä¸Šé¢ä¹Ÿè¯´åˆ°äº†ï¼Œ<code>KCP</code>çš„å¼€å‘æˆæœ¬è¾ƒé«˜ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š<br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd6ebfb207e34e8cb4b7f8a71b6ab54b~tplv-k3u1fbpfcp-watermark.awebp">   </p><ul><li><code>Plugin</code>ï¼š<code>Gradle</code> æ’ä»¶ç”¨æ¥è¯»å– <code>Gradle</code> é…ç½®ä¼ é€’ç»™ <code>KCP</code>ï¼ˆ<code>Kotlin Plugin</code>ï¼‰</li><li><code>Subplugin</code>ï¼šä¸º <code>KCP</code> æä¾›è‡ªå®šä¹‰ <code>KP</code> çš„ <code>maven</code> åº“åœ°å€ç­‰é…ç½®ä¿¡æ¯</li><li><code>CommandLineProcessor</code>ï¼šè´Ÿè´£å°†<code>Plugin</code>ä¼ è¿‡æ¥çš„å‚æ•°è½¬æ¢å¹¶æ ¡éªŒ</li><li><code>ComponentRegistrar</code>ï¼šè´Ÿè´£å°†ç”¨æˆ·è‡ªå®šä¹‰çš„å„ç§<code>Extension</code>æ³¨å†Œåˆ°<code>KP</code>ä¸­ï¼Œå¹¶åœ¨åˆé€‚æ—¶æœºè°ƒç”¨</li></ul><p><code>ComponentRegistrar</code>æ˜¯æ ¸å¿ƒå…¥å£ï¼Œæ‰€æœ‰çš„<code>KCP</code>è‡ªå®šä¹‰åŠŸèƒ½éƒ½éœ€è¦é€šè¿‡è¿™ä¸ªç±»æ³¨å†Œä¸€äº›<code>Extension</code>æ¥å£æ¥å®ç°ã€‚</p><p>ä¸‹é¢åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„<code>Extension</code>æ¥å£ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚é€‰ç”¨ï¼š</p><ul><li><code>IrGenerationExtension</code>ï¼Œç”¨äºå¢/åˆ /æ”¹/æŸ¥ä»£ç </li><li><code>DiagnosticSuppressor</code>ï¼Œç”¨äºæŠ‘åˆ¶è¯­æ³•é”™è¯¯ï¼Œ<code>Jetpack Compose</code>æœ‰ä½¿ç”¨</li><li><code>StorageComponentContainerContributor</code>ï¼Œç”¨äºå®ç°<code>IOC</code></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="composeæ³¨è§£çš„ä½œç”¨"><code>@Compose</code>æ³¨è§£çš„ä½œç”¨<a class="hash-link" href="#composeæ³¨è§£çš„ä½œç”¨" title="Direct link to heading">â€‹</a></h2><p>ä¸Šé¢ä»‹ç»äº†<code>KCP</code>çš„åŸºæœ¬æ¦‚å¿µ,ä¸‹é¢çœ‹ä¸‹åœ¨<code>Jetpack Compose</code>ä¸­<code>@Compose</code>æ³¨è§£åˆ°åº•æ˜¯æ€ä¹ˆè§£æçš„ï¼Œåˆèµ·äº†ä»€ä¹ˆä½œç”¨     </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ³¨å†Œirgenerationextension">æ³¨å†Œ<code>IrGenerationExtension</code><a class="hash-link" href="#æ³¨å†Œirgenerationextension" title="Direct link to heading">â€‹</a></h3><p>ä¸Šé¢æˆ‘ä»¬ä»‹ç»äº†<code>ComponentRegistrar</code>æ˜¯æ ¸å¿ƒå…¥å£ï¼Œè´Ÿè´£å°†ç”¨æˆ·è‡ªå®šä¹‰çš„å„ç§<code>Extension</code>æ³¨å†Œåˆ°<code>KP</code>ä¸­ï¼Œå¹¶åœ¨åˆé€‚æ—¶æœºè°ƒç”¨ï¼Œè€Œ<code>IrGenerationExtension</code>å¯ä»¥ç”¨äºä¿®æ”¹ä»£ç <br>
<code>Compose</code>æ’ä»¶çš„å…¥å£ä¸º<a href="https://github.com/androidx/androidx/blob/35cea032eb39619f1dcad49623727ef3f7ccbc95/compose/compiler/compiler-hosted/src/main/java/androidx/compose/compiler/plugins/kotlin/ComposePlugin.kt" target="_blank" rel="noopener noreferrer">ComposePlugin</a>ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬ä¸€ä¸ª<code>ComposeComponentRegistrar</code>ï¼Œ<code>IrGenerationExtension</code>çš„æ³¨å†Œå°±æ˜¯åœ¨è¿™é‡Œå®Œæˆçš„    </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">class ComposeComponentRegistrar : ComponentRegistrar {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    override fun registerProjectComponents(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        project: MockProject,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        configuration: CompilerConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        registerProjectExtensions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            project as Project,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun registerProjectExtensions(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            project: Project,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            configuration: CompilerConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      IrGenerationExtension.registerExtension(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            project,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ComposeIrGenerationExtension(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}    </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæ³¨å†Œäº†<code>IrGenerationExtension</code>,æ¥ä¸‹æ¥<code>IrGenerationExtension</code>ä¼šè°ƒç”¨<code>ComposerParamTransformer</code>çš„ç›¸å…³æ–¹æ³•ï¼Œå®Œæˆå‚æ•°çš„å¡«å……ï¼Œåç»­çš„ä¸»è¦å¤„ç†å·¥ä½œéƒ½æ˜¯åœ¨<code>ComposerParamTransformer</code>ä¸­å¤„ç†äº†   </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ·»åŠ composer">æ·»åŠ <code>$Composer</code><a class="hash-link" href="#æ·»åŠ composer" title="Direct link to heading">â€‹</a></h3><p>ä¸Šæ–‡è¯´åˆ°ï¼Œåç»­åœ¨å‡½æ•°ä¸­æ·»åŠ å‚æ•°çš„å·¥ä½œä¸»è¦æ˜¯åœ¨<code>ComposerParamTransformer</code>ä¸­å®Œæˆçš„ï¼Œå…·ä½“è°ƒç”¨äº†<code>IrFunction.withComposerParamIfNeeded</code>   </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    private fun IrFunction.withComposerParamIfNeeded(): IrFunction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å¦‚æœä¸æ˜¯`Compose`å‡½æ•°ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œåç»­ä¸å†å¤„ç†</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!this.hasComposableAnnotation()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // å¦‚æœæ­¤å‡½æ•°æ˜¯ä½œä¸ºå‚æ•°çš„`Lambda`ï¼Œå¹¶ä¸”ä¸æ˜¯`Compose`å‡½æ•°ï¼Œåˆ™ç›´æ¥è¿”å›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (isNonComposableInlinedLambda()) return this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ä¸å¤„ç†expectå‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (isExpect) return this</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ç¼“å­˜è½¬æ¢çš„ç»“æœ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return transformedFunctions[this] ?: copyWithComposerParam()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œä¸»è¦å°±æ˜¯åˆ¤æ–­ä¸€ä¸‹å‡½æ•°æ˜¯å¦æœ‰<code>@Compose</code>æ³¨è§£ï¼Œå¦‚æœæ²¡æœ‰åˆ™ç›´æ¥è¿”å›ä¸å†å¤„ç†ï¼Œæœ‰åˆ™ç»§ç»­å¤„ç†å¹¶ç¼“å­˜ç»“æœï¼Œåç»­è°ƒç”¨<code>copyWithComposerParam</code>æ–¹æ³•   </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    private fun IrFunction.copyWithComposerParam(): IrSimpleFunction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return copy().also { fn -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // $composer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            val composerParam = fn.addValueParameter {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                name = KtxNameConventions.COMPOSER_PARAMETER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type = composerType.makeNullable()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                origin = IrDeclarationOrigin.DEFINED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                isAssignable = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œåœ¨æ‰€æœ‰<code>Compose</code>å‡½æ•°ä¸­æ’å…¥äº†ä¸€ä¸ª<code>$composer</code>ï¼Œè¿™æœ‰æ•ˆåœ°ä½¿<code>Composer</code>å¯ç”¨äºä»»ä½•å­æ ‘ï¼Œæä¾›å®ç°<code>Composable</code>æ ‘å¹¶ä¿æŒæ›´æ–°æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚     </p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdb3d8fa5fdd4d54a34618f47fd1869c~tplv-k3u1fbpfcp-zoom-1.image"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ·»åŠ changed">æ·»åŠ <code>$changed</code><a class="hash-link" href="#æ·»åŠ changed" title="Direct link to heading">â€‹</a></h3><p>æˆ‘ä»¬çŸ¥é“<code>Compose</code>å­˜åœ¨æ™ºèƒ½é‡ç»„æœºåˆ¶ï¼Œå½“è¾“å…¥å®Œå…¨ç›¸åŒæ—¶å…è®¸è·³è¿‡é‡ç»„ï¼Œè€Œç¼–è¯‘å™¨é™¤äº†<code>$composer</code>ï¼Œè¿˜ä¼šæ³¨å…¥<code>$changed</code> å‚æ•°ã€‚ æ­¤å‚æ•°ç”¨äºæä¾›æœ‰å…³å½“å‰ <code>Composable</code> çš„è¾“å…¥å‚æ•°ä¸ä¸€æ¬¡å‘ç”Ÿç»„ä»¶åæ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™å…è®¸è·³è¿‡é‡ç»„ã€‚</p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    private fun IrFunction.copyWithComposerParam(): IrSimpleFunction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return copy().also { fn -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // $changed[n]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            val changed = KtxNameConventions.CHANGED_PARAMETER.identifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //changedparamCount,è®¡ç®—$changedæ•°é‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            for (i in 0 until changedParamCount(realParams, fn.thisParamCount)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                fn.addValueParameter(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (i == 0) changed else &quot;$changed$i&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    context.irBuiltIns.intType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæ·»åŠ çš„æ˜¯ä¸ª<code>$changed[n]</code>,è¿™ä¸ª<code>n</code>æ˜¯ä»ä½•è€Œæ¥å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæ¯ä¸ªå‚æ•°çš„çŠ¶æ€æœ‰5ç§æƒ…å†µ,<code>compose</code>ä¸­å®šä¹‰äº†ä¸€ä¸ªæšä¸¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š   </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">enum class ParamState(val bits: Int) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Uncertain(0b000),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Same(0b001),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Different(0b010),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Static(0b011),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Unknown(0b100),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mask(0b111);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<code>$changed</code>é€šè¿‡ä½è¿ç®—çš„æ–¹å¼æ¥è¡¨ç¤ºå‚æ•°æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼š       </p><ol><li><code>$changed</code>æ˜¯<code>Int</code>ç±»å‹ï¼Œä¸€ä¸ªå 32ä½     </li><li>æ¯ä¸ªå‚æ•°æœ‰5ç§ç±»å‹ï¼Œå› æ­¤ä¸€ä¸ªå‚æ•°éœ€è¦3ä½æ¥è¡¨ç¤º    </li><li>å› æ­¤ä¸€ä¸ª<code>$changed</code>å¯ä»¥è¡¨ç¤º10ä¸ªå‚æ•°æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœè¶…å‡ºåˆ™éœ€è¦å†æ·»åŠ ä¸€ä¸ª<code>$changed</code>å‚æ•°    </li></ol><p>ç¼–è¯‘å™¨æ³¨å…¥<code>$changed</code>ä¹‹åæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š  </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun A(x: Int, $composer: Composer&lt;*&gt;, $changed: Int) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var $dirty = $changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if ($changed and 0b0110 === 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $dirty = $dirty or if ($composer.changed(x)) 0b0010 else 0b0100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (%dirty and 0b1011 !== 0b1010 || !$composer.skipping) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            f(x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            $composer.skipToGroupEnd()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="æ·»åŠ default">æ·»åŠ <code>$default</code><a class="hash-link" href="#æ·»åŠ default" title="Direct link to heading">â€‹</a></h3><p><code>Kotlin</code> æ”¯æŒçš„é»˜è®¤å‚æ•°ä¸é€‚ç”¨äºå¯ç»„åˆå‡½æ•°çš„å‚æ•°ï¼Œå› ä¸ºå¯ç»„åˆå‡½æ•°éœ€è¦åœ¨å‡½æ•°çš„ä½œç”¨åŸŸï¼ˆç”Ÿæˆçš„ç»„ï¼‰å†…ä¸ºå…¶å‚æ•°æ‰§è¡Œé»˜è®¤è¡¨è¾¾å¼ã€‚ ä¸ºæ­¤ï¼Œ<code>Compose</code> æä¾›äº†é»˜è®¤å‚æ•°è§£ææœºåˆ¶çš„æ›¿ä»£å®ç°ã€‚å³åœ¨<code>Compose</code>æ–¹æ³•ä¸­æ·»åŠ <code>$defaulut</code>    </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    private fun IrFunction.copyWithComposerParam(): IrSimpleFunction {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       // $default[n]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       if (oldFn.requiresDefaultParameter()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           val defaults = KtxNameConventions.DEFAULT_PARAMETER.identifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           for (i in 0 until defaultParamCount(realParams)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               fn.addValueParameter(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   if (i == 0) defaults else &quot;$defaults$i&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   context.irBuiltIns.intType,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   IrDeclarationOrigin.MASK_FOR_DEFAULT_FUNCTION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       }            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>$default</code>ä¸<code>$changed</code>ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡ä½è¿ç®—æ¥è¡¨ç¤ºå‚æ•°çŠ¶æ€çš„ï¼Œä¸è¿‡<code>$default</code>æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€ï¼Œä½¿ç”¨è¿˜æ˜¯ä¸ä½¿ç”¨é»˜è®¤å€¼ï¼Œå› æ­¤ä¸€ä¸ª<code>$changed</code>å‚æ•°å¯è¡¨ç¤º31ä¸ªå‚æ•°æ˜¯å¦ä½¿ç”¨é»˜è®¤å€¼ï¼Œå¦‚æœè¶…å‡ºå†æ·»åŠ ä¸€ä¸ª<code>$changed</code><br>
<!-- -->ç¼–è¯‘å™¨æ³¨å…¥<code>$default</code>åçš„æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š   </p><div class="codeBlockContainer_I0IT language-kotlin theme-code-block"><div class="codeBlockContent_wNvx kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Composable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun A(x: Int, $default: Int) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val x = if ($default and 0b1 != 0) 0 else x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f(x)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ€»ç»“">æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">â€‹</a></h2><p>æœ¬æ–‡ä¸»è¦ç®€å•ä»‹ç»äº†ä»€ä¹ˆæ˜¯<code>KCP</code>åŠ<code>KCP</code>æ˜¯å¦‚ä½•å¤„ç†<code>@Compose</code>æ³¨è§£çš„ï¼Œä»ä¸­å¯ä»¥çœ‹åˆ°<code>KCP</code>çš„å¼ºå¤§ä¸å¤æ‚ï¼Œå¦‚æœä½ åªéœ€è¦è§£ææ³¨è§£ç”Ÿæˆä»£ç çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨<code>KSP</code>å–ä»£<code>KAPT</code>ï¼Œå¦‚æœæœ‰æ›´å¤šéœ€æ±‚ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨<code>KCP</code><br>
<!-- -->åŒæ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°<code>Compose</code>è®¾è®¡çš„å·§å¦™ï¼Œå°†æ¡†æ¶èƒŒåçš„å¤æ‚åº¦å®Œå…¨éšè—ï¼ŒèƒŒååšäº†è¿™ä¹ˆå¤šå·¥ä½œï¼Œä½¿ç”¨éƒ½å´åªéœ€æ·»åŠ ä¸€ä¸ª<code>@Compose</code>æ³¨è§£ï¼Œå°±èƒ½å°†ä¸€ä¸ªæ™®é€šçš„å‡½æ•°å˜æˆ<code>Compose</code>å‡½æ•°ï¼Œçš„ç¡®æ˜¯æŒºç®€æ´ä¼˜é›…çš„ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥çœ‹æºç ~    </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™<a class="hash-link" href="#å‚è€ƒèµ„æ–™" title="Direct link to heading">â€‹</a></h3><p><a href="https://juejin.cn/post/6979759813467062309" target="_blank" rel="noopener noreferrer">å‘Šåˆ«KAPTï¼ä½¿ç”¨ KSP ä¸º Kotlin ç¼–è¯‘æé€Ÿ</a><br>
<a href="https://www.bilibili.com/video/BV1Tf4y157ku" target="_blank" rel="noopener noreferrer">Kotlin ç¼–è¯‘å™¨æ’ä»¶ï¼šæˆ‘ä»¬ç©¶ç«Ÿåœ¨æœŸå¾…ä»€ä¹ˆï¼Ÿ</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/compose-museum/jetpack-compose-book/tree/master/docs/principle/composeAnnotation.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/principle/modifierStructure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">å›¾è§£ Modifier</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/principle/composeRemoteImage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">å¦‚ä½•ä¸ºCompose Imageæä¾›ç½‘ç»œå›¾ç‰‡åŠ è½½æ”¯æŒ</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#å‰è¨€" class="table-of-contents__link toc-highlight">å‰è¨€</a></li><li><a href="#å‰ç½®çŸ¥è¯†" class="table-of-contents__link toc-highlight">å‰ç½®çŸ¥è¯†</a><ul><li><a href="#ä»€ä¹ˆæ˜¯kcp" class="table-of-contents__link toc-highlight">ä»€ä¹ˆæ˜¯<code>KCP</code></a></li><li><a href="#kcpçš„åŸºæœ¬æ¦‚å¿µ" class="table-of-contents__link toc-highlight"><code>KCP</code>çš„åŸºæœ¬æ¦‚å¿µ</a></li></ul></li><li><a href="#composeæ³¨è§£çš„ä½œç”¨" class="table-of-contents__link toc-highlight"><code>@Compose</code>æ³¨è§£çš„ä½œç”¨</a><ul><li><a href="#æ³¨å†Œirgenerationextension" class="table-of-contents__link toc-highlight">æ³¨å†Œ<code>IrGenerationExtension</code></a></li><li><a href="#æ·»åŠ composer" class="table-of-contents__link toc-highlight">æ·»åŠ <code>$Composer</code></a></li><li><a href="#æ·»åŠ changed" class="table-of-contents__link toc-highlight">æ·»åŠ <code>$changed</code></a></li><li><a href="#æ·»åŠ default" class="table-of-contents__link toc-highlight">æ·»åŠ <code>$default</code></a></li></ul></li><li><a href="#æ€»ç»“" class="table-of-contents__link toc-highlight">æ€»ç»“</a><ul><li><a href="#å‚è€ƒèµ„æ–™" class="table-of-contents__link toc-highlight">å‚è€ƒèµ„æ–™</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/compose-museum" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Jetpack Compose åšç‰©é¦†, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b8d28577.js"></script>
<script src="/assets/js/main.4a02c241.js"></script>
</body>
</html>